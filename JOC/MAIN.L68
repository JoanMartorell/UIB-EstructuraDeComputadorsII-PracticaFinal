0000321E Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 17/01/2024 11:22:29

00000000                             1  ; =============================================================================
00000000                             2  ; TÍTULO   : SPACE SHOOTER
00000000                             3  ; AUTORES  : PAU TONI BIBILONI MARTÍNEZ
00000000                             4  ;            JOAN MARTORELL COLL
00000000                             5  ; CREACIÓN : 17-ENE-2024
00000000                             6  ; =============================================================================
00000000                             7  
00001000                             8              ORG     $1000
00001000                             9  
00001000                            10  ; --- INCLUSIONES DE CÓDIGO ---------------------------------------------------
00001000                            11  
00001000                            12              INCLUDE "SYSCONST.X68"          ; CONSTANTES DEL SISTEMA
00001000                            13  ; =============================================================================
00001000                            14  ; CONSTANTES DEL SISTEMA
00001000                            15  ; =============================================================================
00001000                            16  
00001000                            17  ; --- CONSTANTES RELACIONADAS CON TRAP ----------------------------------------
00001000                            18  
00001000  =00000000                 19  KBDTRAP     EQU     0                       ; TRAP DE ACTUALIZACIÓN DEL TECLADO
00001000  =00000001                 20  SCRTRAP     EQU     1                       ; TRAP DE REFRESCO DE PANTALLA
00001000                            21  
00001000                            22  ; --- CÓDIGOS DE TECLAS (EASy68K)
00001000                            23  
00001000  =00000020                 24  KBDCHRSP    EQU     $20                     ; TECLA ESPACIO
00001000  =0000004D                 25  KBDCHRMK    EQU     'M'                     ; TECLA M
00001000  =00000010                 26  KBDCHRSH    EQU     $10                     ; TECLA SHIFT
00001000  =00000050                 27  KBDCHRPK    EQU     'P'                     ; TECLA P
00001000  =00000025                 28  KBDCHRLF    EQU     $25                     ; TECLA IZQUIERDA
00001000  =00000026                 29  KBDCHRUP    EQU     $26                     ; TECLA ARRIBA
00001000  =00000027                 30  KBDCHRRT    EQU     $27                     ; TECLA DERECHA
00001000  =00000028                 31  KBDCHRDN    EQU     $28                     ; TECLA ABAJO
00001000                            32  
00001000                            33  ; --- MAPEO DEL TECLADO -------------------------------------------------------
00001000                            34  
00001000  =00000025                 35  KBDLEFT     EQU     KBDCHRLF                ; BOTÓN IZQUIERDO
00001000  =00000026                 36  KBDUP       EQU     KBDCHRUP                ; BOTÓN ARRIBA
00001000  =00000027                 37  KBDRIGHT    EQU     KBDCHRRT                ; BOTÓN DERECHO
00001000  =00000028                 38  KBDDOWN     EQU     KBDCHRDN                ; BOTÓN ABAJO
00001000  =00000020                 39  KBDFIRE1    EQU     KBDCHRSP                ; BOTÓN DISPARO 1
00001000  =0000004D                 40  KBDFIRE2    EQU     KBDCHRMK                ; BOTÓN DISPARO 2
00001000  =00000010                 41  KBDFIRE3    EQU     KBDCHRSH                ; BOTÓN DISPARO 3
00001000  =00000050                 42  KBDPAUSE    EQU     KBDCHRPK                ; BOTÓN PAUSA
00001000                            43  
00001000                            44  ; --- MÁSCARAS DE CAMPO DE BITS DEL TECLADO -----------------------------------
00001000                            45  ; CONSTANTES DE CONVENIENCIA PARA ACCEDER AL SIGUIENTE CAMPO DE BITS.
00001000                            46  ; ESTE CAMPO DE BITS ES UTILIZADO POR LAS VARIABLES DEL SISTEMA (KBDVAL) Y (KBDEDGE).
00001000                            47  ; +---+---+---+---+---+---+---+---+
00001000                            48  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
00001000                            49  ; +---+---+---+---+---+---+---+---+
00001000                            50  ;   |   |   |   |   |   |   |   |
00001000                            51  ;   |   |   |   |   |   |   |   +---------- BOTÓN IZQUIERDO
00001000                            52  ;   |   |   |   |   |   |   +-------------- BOTÓN ARRIBA
00001000                            53  ;   |   |   |   |   |   +------------------ BOTÓN DERECHO
00001000                            54  ;   |   |   |   |   +---------------------- BOTÓN ABAJO
00001000                            55  ;   |   |   |   +-------------------------- BOTÓN DISPARO 1
00001000                            56  ;   |   |   +------------------------------ BOTÓN DISPARO 2
00001000                            57  ;   |   +---------------------------------- BOTÓN DISPARO 3
00001000                            58  ;   +-------------------------------------- BOTÓN PAUSA
00001000                            59  
00001000  =00000001                 60  KBDMSKLF    EQU     %00000001
00001000  =00000002                 61  KBDMSKUP    EQU     %00000010
00001000  =00000004                 62  KBDMSKRT    EQU     %00000100
00001000  =00000008                 63  KBDMSKDN    EQU     %00001000
00001000  =00000010                 64  KBDMSKF1    EQU     %00010000
00001000  =00000020                 65  KBDMSKF2    EQU     %00100000
00001000  =00000040                 66  KBDMSKF3    EQU     %01000000
00001000  =00000080                 67  KBDMSKPS    EQU     %10000000
00001000                            68  
00001000                            69  ; --- POSICIONES DE CAMPO DE BITS DEL TECLADO ---------------------------------
00001000                            70  
00001000  =00000000                 71  KBDBITLF    EQU     0                       ; POSICIÓN DEL BOTÓN IZQUIERDO
00001000  =00000001                 72  KBDBITUP    EQU     1                       ; POSICIÓN DEL BOTÓN ARRIBA
00001000  =00000002                 73  KBDBITRT    EQU     2                       ; POSICIÓN DEL BOTÓN DERECHO
00001000  =00000003                 74  KBDBITDN    EQU     3                       ; POSICIÓN DEL BOTÓN ABAJO
00001000  =00000004                 75  KBDBITF1    EQU     4                       ; POSICIÓN DEL BOTÓN DISPARO 1
00001000  =00000005                 76  KBDBITF2    EQU     5                       ; POSICIÓN DEL BOTÓN DISPARO 2
00001000  =00000006                 77  KBDBITF3    EQU     6                       ; POSICIÓN DEL BOTÓN DISPARO 3
00001000  =00000007                 78  KBDBITPS    EQU     7                       ; POSICIÓN DEL BOTÓN PAUSA
00001000                            79  
00001000                            80  ; --- CONSTANTES RELACIONADAS CON LA PANTALLA ---------------------------------
00001000                            81  
00001000  =00000280                 82  SCRWIDTH    EQU     640                     ; ANCHO DE LA PANTALLA (PIXELES)
00001000  =00000280                 83  SCRHEIGH    EQU     640                     ; ALTURA DE LA PANTALLA (PIXELES)
00001000  =00000001                 84  SCRIRQ      EQU     1                       ; Nº DE INTERRUPCIÓN DE LA PANTALLA
00001000  =00000014                 85  SCRTIM      EQU     20                      ; TEMPORIZADOR DE LA PANTALLA (MS)
00001000                            86  
00001000                            87  ; --- CONSTANTES DE MEMORIA DINÁMICA ------------------------------------------
00001000                            88  
00001000  =00000040                 89  DMMBSIZE    EQU     64                      ; TAMAÑO BLOQUE(BYTES). 2 ELEVADO X
00001000  =00000032                 90  DMMBNUM     EQU     50                      ; NÚMERO DE BLOQUES
00001000  =00000000                 91  DMMSYSID    EQU     0                       ; ID DEL PROPIETARIO DEL SISTEMA 
00001000  =00000000                 92  -------------------- end include --------------------
00001000                            93              INCLUDE "SYSTEM.X68"            ; CÓDIGO DEL SISTEMA
00001000                            94  ; =============================================================================
00001000                            95  ; TÍTULO   : GESTIÓN DEL SISTEMA (CÓDIGO DEL SISTEMA)
00001000                            96  ; AUTORES  : PAU TONI BIBILONI MARTÍNEZ
00001000                            97  ;            JOAN MARTORELL COLL
00001000                            98  ; COMENTARIOS : SE DIVIDE EN TRES BLOQUES:
00001000                            99  ;               - SYS : GENÉRICO.
00001000                           100  ;               - SCR : GESTIÓN DE LA PANTALLA.
00001000                           101  ;               - KBD : GESTIÓN DEL TECLADO.
00001000                           102  ; =============================================================================
00001000                           103  
00001000                           104  ; -----------------------------------------------------------------------------
00001000                           105  SYSINIT
00001000                           106  ; INICIALIZA EL SISTEMA
00001000                           107  ; ENTRADA  - NINGUNA
00001000                           108  ; SALIDA   - NINGUNA
00001000                           109  ; MODIFICA - NINGUNA
00001000                           110  ; -----------------------------------------------------------------------------
00001000  205F                     111              MOVE.L  (A7)+,A0                ; OBTIENE LA DIRECCIÓN DE RETORNO
00001002  4EB9 000010B4            112              JSR     KBDINIT                 ; INICIALIZA EL TECLADO
00001008  4EB9 0000101C            113              JSR     SCRINIT                 ; INICIALIZA LA PANTALLA
0000100E  4EB9 00001114            114              JSR     DMMINIT                 ; INICIALIZA LA MEMORIA DINÁMICA
00001014  027C DFFF                115              ANDI.W  #$DFFF,SR               ; CAMBIA A MODO USUARIO
00001018  2F08                     116              MOVE.L  A0,-(A7)                ; PONE LA DIRECCIÓN DE RETORNO
0000101A  4E75                     117              RTS
0000101C                           118  
0000101C                           119  ; =============================================================================
0000101C                           120  ; GESTIÓN DE LA PANTALLA (CÓDIGO DEL SISTEMA)
0000101C                           121  ; =============================================================================
0000101C                           122  
0000101C                           123  ; -----------------------------------------------------------------------------
0000101C                           124  SCRINIT
0000101C                           125  ; INICIALIZA LA PANTALLA, LA INTERRUPCIÓN RELACIONADA CON LA PANTALLA Y LAS VARIABLES.
0000101C                           126  ; ENTRADA  - NINGUNA
0000101C                           127  ; SALIDA   - NINGUNA
0000101C                           128  ; MODIFICA - D0,D1,D2,D3
0000101C                           129  ; -----------------------------------------------------------------------------
0000101C  007C 0700                130              ORI.W   #$0700,SR               ; DESACTIVA TODAS LAS INTERRUPCIONES
00001020  21FC 0000109A 0084       131              MOVE.L  #SCRUPD,($80+SCRTRAP*4) ; INSTALA LA TRAMPA
00001028  223C 02800280            132              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1 ; ESTABLECE LA RESOLUCIÓN
0000102E  103C 0021                133              MOVE.B  #33,D0
00001032  4E4F                     134              TRAP    #15
00001034  7201                     135              MOVE.L  #1,D1                   ; ESTABLECE EL MODO DE VENTANA
00001036  4E4F                     136              TRAP    #15
00001038  323C FF00                137              MOVE.W  #$FF00,D1               ; LIMPIA EL BUFFER VISIBLE
0000103C  103C 000B                138              MOVE.B  #11,D0
00001040  4E4F                     139              TRAP    #15
00001042  123C 0011                140              MOVE.B  #17,D1                  ; HABILITA EL DOBLE BUFFER
00001046  103C 005C                141              MOVE.B  #92,D0
0000104A  4E4F                     142              TRAP    #15
0000104C  323C FF00                143              MOVE.W  #$FF00,D1               ; LIMPIA EL BUFFER OCULTO
00001050  103C 000B                144              MOVE.B  #11,D0
00001054  4E4F                     145              TRAP    #15
00001056  21FC 0000108C 0064       146              MOVE.L  #SCRISR,($60+SCRIRQ*4)  ; ESTABLECE EL VECTOR DE EXCEPCIÓN
0000105E  123C 0005                147              MOVE.B  #5,D1                   ; HABILITA EL PROCESAMIENTO DE EXCEPCIONES
00001062  103C 0020                148              MOVE.B  #32,D0
00001066  4E4F                     149              TRAP    #15
00001068  143C 0081                150              MOVE.B  #%10000000|SCRIRQ,D2    ; HABILITA AUTO-IRQ
0000106C  163C 0014                151              MOVE.B  #SCRTIM,D3
00001070  123C 0006                152              MOVE.B  #6,D1
00001074  103C 0020                153              MOVE.B  #32,D0
00001078  4E4F                     154              TRAP    #15
0000107A  4239 000032A0            155              CLR.B   (SCRINTCT)              ; PREPARA LA BANDERA DE INTERRUPCIÓN
00001080  4239 000032A1            156              CLR.B   (SCRCYCCT)              ; PREPARA EL CONTADOR DE CICLOS
00001086  027C F8FF                157              ANDI.W  #$F8FF,SR               ; HABILITA LAS INTERRUPCIONES
0000108A  4E75                     158              RTS
0000108C                           159  
0000108C                           160  ; -----------------------------------------------------------------------------
0000108C                           161  SCRISR
0000108C                           162  ; ISR DEL TEMPORIZADOR DE LA PANTALLA. AUMENTA EL CONTADOR DE INTERRUPCIONES Y ACTUALIZA EL DOBLE BUFFER.
0000108C                           163  ; ENTRADA  - NINGUNA
0000108C                           164  ; SALIDA   - NINGUNA
0000108C                           165  ; MODIFICA - NINGUNA
0000108C                           166  ; -----------------------------------------------------------------------------
0000108C  5239 000032A0            167              ADDQ.B  #1,(SCRINTCT)           ; ACTUALIZA LA BANDERA/CONTADOR DE INTERRUPCIÓN
00001092  5239 000032A1            168              ADDQ.B  #1,(SCRCYCCT)           ; ACTUALIZA EL CONTADOR DE CICLOS
00001098  4E73                     169              RTE
0000109A                           170              
0000109A                           171  ; -----------------------------------------------------------------------------
0000109A                           172  SCRUPD
0000109A                           173  ; RUTINA DE SERVICIO DE TRAP ENCARGADA DE VISUALIZAR EL MARCO ACTUAL Y LIMPIAR
0000109A                           174  ; BUFFER PARA EL SIGUIENTE.
0000109A                           175  ; ENTRADA  - NINGUNA
0000109A                           176  ; SALIDA   - NINGUNA
0000109A                           177  ; MODIFICA - NINGUNA
0000109A                           178  ; -----------------------------------------------------------------------------
0000109A  48A7 C000                179              MOVEM.W D0-D1,-(A7)
0000109E  103C 005E                180              MOVE.B  #94,D0                  ; ACTUALIZAR DOBLE BUFFER
000010A2  4E4F                     181              TRAP    #15
000010A4  323C FF00                182              MOVE.W  #$FF00,D1               ; BORRAR BUFFER OCULTO
000010A8  103C 000B                183              MOVE.B  #11,D0
000010AC  4E4F                     184              TRAP    #15
000010AE  4C9F 0003                185              MOVEM.W (A7)+,D0-D1
000010B2  4E73                     186              RTE
000010B4                           187  
000010B4                           188  ; =============================================================================
000010B4                           189  ; GESTIÓN DEL TECLADO (CÓDIGO DEL SISTEMA)
000010B4                           190  ; =============================================================================
000010B4                           191  
000010B4                           192  ; -----------------------------------------------------------------------------
000010B4                           193  KBDINIT
000010B4                           194  ; INICIALIZA LAS VARIABLES DEL SISTEMA KBDSYS Y KBDVAL
000010B4                           195  ; ENTRADA  - NINGUNA
000010B4                           196  ; SALIDA   - NINGUNA
000010B4                           197  ; MODIFICA - NINGUNA
000010B4                           198  ; -----------------------------------------------------------------------------
000010B4  4239 0000329E            199              CLR.B   (KBDVAL)                 ; INICIAR VARS
000010BA  4239 0000329F            200              CLR.B   (KBDEDGE)
000010C0  21FC 000010CA 0080       201              MOVE.L  #KBDREAD,($80+KBDTRAP*4) ; INSTALAR
000010C8  4E75                     202              RTS
000010CA                           203  
000010CA                           204  ; -----------------------------------------------------------------------------
000010CA                           205  KBDREAD
000010CA                           206  ; RUTINA DE SERVICIO DE TRAP.
000010CA                           207  ; ACTUALIZA LAS VARIABLES DEL SISTEMA KBDEDGE Y KBDVAL SEGÚN EL BITFIELD
000010CA                           208  ; DESCRITO EN SYSCONST. KBDVAL MANTIENE LOS VALORES ACTUALES Y KBDEFGE MANTIENE
000010CA                           209  ; LOS BORDES AUMENTADOS DE LA LLAMADA ANTERIOR A LA ACTUAL.
000010CA                           210  ; ENTRADA  - NINGUNA
000010CA                           211  ; SALIDA   - (KBDVAL) Y (KBDEDGE)
000010CA                           212  ; MODIFICA - NINGUNA
000010CA                           213  ; -----------------------------------------------------------------------------
000010CA  48E7 F000                214              MOVEM.L D0-D3,-(A7)
000010CE  103C 0013                215              MOVE.B  #19,D0
000010D2  223C 50104D20            216              MOVE.L  #KBDPAUSE<<24+KBDFIRE3<<16+KBDFIRE2<<8+KBDFIRE1,D1
000010D8  4E4F                     217              TRAP    #15
000010DA  6100 002A                218              BSR     .STORE                ; ALMACENAR FIRE1,FIRE2,FIRE3 Y PAUSE
000010DE  223C 28272625            219              MOVE.L  #KBDDOWN<<24+KBDRIGHT<<16+KBDUP<<8+KBDLEFT,D1
000010E4  4E4F                     220              TRAP    #15
000010E6  6100 001E                221              BSR     .STORE                ; ALAMACENAR KEY UP,DOWN,LEFT Y RIGTH
000010EA  1039 0000329E            222              MOVE.B  (KBDVAL),D0           ; BORDE DE COMPUTACIÓN
000010F0  4600                     223              NOT.B   D0                    ; BORDE = NO(ANTERIOR) Y ACTUAL
000010F2  C002                     224              AND.B   D2,D0
000010F4  13C2 0000329E            225              MOVE.B  D2,(KBDVAL)           ; ALMACENAR VALORES (PRESS Y BORDE)
000010FA  13C0 0000329F            226              MOVE.B  D0,(KBDEDGE)
00001100  4CDF 000F                227              MOVEM.L (A7)+,D0-D3
00001104  4E73                     228              RTE
00001106                           229  
00001106  363C 0003                230  .STORE      MOVE.W  #3,D3                 ; TRADUCE LA CODIFICACIÓN DE 8-BIT
0000110A  E189                     231  .LOOP       LSL.L   #8,D1                 ; DEL TRAP #15 TASK 19 EN UN 1-BIT
0000110C  E312                     232              ROXL.B  #1,D2                 ; CODIFICACIÓN POR PULSIÓN DE TECLA
0000110E  51CB FFFA                233              DBRA.W  D3,.LOOP
00001112  4E75                     234              RTS
00001114                           235  
00001114                           236  ; =============================================================================
00001114                           237  ; GESTIÓN DE MEMORIA DINÁMICA (CÓDIGO DEL SISTEMA)
00001114                           238  ; LA MEMORIA DINÁMICA ES UN CONJNT DE DMMBNUM SLOTS DE DMMBSIZE BYTES CADA UNA.
00001114                           239  ; DMMBSIZE DEBE SER POTENCIA DE DOS. UNA RANURA TIENE:
00001114                           240  ; - ENCABEZADO - 1 WORD. ESPECIFICA EL PROPIETARIO (0 = PROPIEDAD DEL SISTEMA)
00001114                           241  ; - DATOS   - DMMBSIZE - 2 BYTES. PUEDE CONTENER VARIABLES Y CUALQUIER TIPO DE
00001114                           242  ;             DATOS RELACIONADOS CON EL PROPIETARIO. SI OWNER==0, LOS DATOS NO
00001114                           243  ;             TIENEN SENTIDO.
00001114                           244  ; =============================================================================
00001114                           245  
00001114                           246  ; -----------------------------------------------------------------------------
00001114                           247  DMMINIT
00001114                           248  ; INICIALIZA LA MEMORIA DINÁMICA PARA QUE TODA SEA PROPIEDAD DEL SISTEMA.
00001114                           249  ; ENTRADA  - NINGUNA
00001114                           250  ; SALIDA   - NINGUNA
00001114                           251  ; MODIFICA - NINGUNA
00001114                           252  ; -----------------------------------------------------------------------------
00001114  48E7 8080                253              MOVEM.L D0/A0,-(A7)
00001118  41F9 000032C0            254              LEA     DMMDATA,A0
0000111E  303C 0031                255              MOVE.W  #DMMBNUM-1,D0
00001122  30BC 0000                256  .LOOP       MOVE.W  #DMMSYSID,(A0)
00001126  D1FC 00000040            257              ADD.L   #DMMBSIZE,A0
0000112C  51C8 FFF4                258              DBRA.W  D0,.LOOP
00001130  4CDF 0101                259              MOVEM.L (A7)+,D0/A0
00001134  4E75                     260              RTS
00001136                           261  
00001136                           262  ; -----------------------------------------------------------------------------
00001136                           263  DMMFIRST
00001136                           264  ; BUSCA EL PRIMER SLOT DE MEMORIA NO PROPIEDAD DEL SISTEMA Y DEVUELVE UN 
00001136                           265  ; PUNTERO A LOS DATOS CORRESPONDIENTES (DIRECCIÓN DEL SLOT + 2)
00001136                           266  ; ENTRADA  - NINGUNA
00001136                           267  ; SALIDA   - A0   : PUNTERO A LOS DATOS O 0 SI NO SE ENCUENTRA
00001136                           268  ; MODIFICA - NINGUNA (APARTE DE LA SALIDA)
00001136                           269  ; -----------------------------------------------------------------------------
00001136  41F9 000032C0            270              LEA     DMMDATA,A0
0000113C  4A58                     271  DMMFRLOP    TST.W   (A0)+
0000113E  6600 0016                272              BNE     DMMFRFND
00001142  D1FC 0000003E            273              ADD.L   #DMMBSIZE-2,A0
00001148  B1FC 00003F3F            274  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
0000114E  6DEC                     275              BLT     DMMFRLOP
00001150  207C 00000000            276              MOVE.L  #0,A0
00001156  4E75                     277  DMMFRFND    RTS
00001158                           278  
00001158                           279  ; -----------------------------------------------------------------------------
00001158                           280  DMMNEXT
00001158                           281  ; BUSCA EL SIGUIENTE SLOT DE MEMORIA NO PROPIEDAD DEL SISTEMA Y DEVUELVE UN 
00001158                           282  ; PUNTERO A LOS DATOS CORRESPONDIENTES (DIRECCIÓN DEL SLOT + 2)
00001158                           283  ; ENTRADA  - A0   : PUNTERO DENTRO DEL SLOT ACTUAL
00001158                           284  ; SALIDA   - A0   : PUNTERO A LOS DATOS O 0 SI NO SE ENCUENTRA
00001158                           285  ; MODIFICA - NINGUNA (APARTE DE LA SALIDA)
00001158                           286  ; -----------------------------------------------------------------------------
00001158  2F00                     287              MOVE.L  D0,-(A7)
0000115A  2008                     288              MOVE.L  A0,D0
0000115C  C0BC FFFFFFC0            289              AND.L   #-DMMBSIZE,D0           ; APROVECHA LA ALINEACIÓN
00001162  0680 00000040            290              ADD.L   #DMMBSIZE,D0
00001168  2040                     291              MOVE.L  D0,A0
0000116A  201F                     292              MOVE.L  (A7)+,D0
0000116C  60DA                     293              BRA     DMMFRCOM
0000116E                           294  ; -----------------------------------------------------------------------------
0000116E                           295  DMMFRSTO
0000116E                           296  ; BUSCA EL PRIMER SLOT DE MEMORIA CON EL ID ESPECIFICADO Y DEVUELVE UN PUNTERO
0000116E                           297  ; A LOS DATOS CORRESPONDIENTES (DIRECCIÓN DEL SLOT + 2)
0000116E                           298  ; ENTRADA  - D0.W : ID A BUSCAR
0000116E                           299  ; SALIDA   - A0   : PUNTERO A LOS DATOS O 0 SI NO SE ENCUENTRA
0000116E                           300  ; MODIFICA - NINGUNA (APARTE DE LA SALIDA)
0000116E                           301  ; -----------------------------------------------------------------------------
0000116E  41F9 000032C0            302              LEA     DMMDATA,A0
00001174  B058                     303  DMMFLOOP    CMP.W   (A0)+,D0
00001176  6700 0016                304              BEQ     DMMFFND
0000117A  D1FC 0000003E            305              ADD.L   #DMMBSIZE-2,A0
00001180  B1FC 00003F3F            306  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001186  6DEC                     307              BLT     DMMFLOOP
00001188  207C 00000000            308              MOVE.L  #0,A0
0000118E  4E75                     309  DMMFFND     RTS
00001190                           310  
00001190                           311  ; -----------------------------------------------------------------------------
00001190                           312  DMMNEXTO
00001190                           313  ; BUSCA LA SIGUIENTE RANURA DE MEMORIA CON EL ID ESPECIFICADO Y DEVUELVE UN PUNTERO
00001190                           314  ; A LOS DATOS CORRESPONDIENTES (DIRECCIÓN DEL SLOT + 2)
00001190                           315  ; ENTRADA  - D0.W : ID A BUSCAR
00001190                           316  ;            A0   : PUNTERO DENTRO DEL SLOT ACTUAL
00001190                           317  ; SALIDA   - A0   : PUNTERO A LOS DATOS O 0 SI NO SE ENCUENTRA
00001190                           318  ; MODIFICA - NINGUNA (APARTE DE LA SALIDA)
00001190                           319  ; -----------------------------------------------------------------------------
00001190  2F00                     320              MOVE.L  D0,-(A7)
00001192  2008                     321              MOVE.L  A0,D0
00001194  C0BC FFFFFFC0            322              AND.L   #-DMMBSIZE,D0           ; APROVECHA LA ALINEACIÓN
0000119A  0680 00000040            323              ADD.L   #DMMBSIZE,D0
000011A0  2040                     324              MOVE.L  D0,A0
000011A2  201F                     325              MOVE.L  (A7)+,D0
000011A4  60DA                     326              BRA     DMMFCOM
000011A6                           327  
000011A6                           328  ; -----------------------------------------------------------------------------
000011A6                           329  DMMALLOC
000011A6                           330  ; BUSCA EL PRIMER SLOT LIBRE (PROPIEDAD DEL SISTEMA), ASIGNA AL 
000011A6                           331  ; PROPIETARIO  ESPECIFICADO Y DEVUELVE UN PUNTERO A LOS DATOS 
000011A6                           332  ; CORRESPONDIENTES (DIRECCIÓN DEL SLOT + 2)
000011A6                           333  ; ENTRADA  - D0.W : ID A ASIGNAR
000011A6                           334  ; SALIDA   - A0   : PUNTERO A LOS DATOS O 0 SI NO HAY ESPACIO LIBRE
000011A6                           335  ; MODIFICA - NINGUNA (APARTE DE LA SALIDA)
000011A6                           336  ; -----------------------------------------------------------------------------
000011A6  3F00                     337              MOVE.W  D0,-(A7)
000011A8  4240                     338              CLR.W   D0
000011AA  4EB8 116E                339              JSR     DMMFRSTO
000011AE  301F                     340              MOVE.W  (A7)+,D0
000011B0  B1FC 00000000            341              CMP.L   #0,A0
000011B6  6700 0006                342              BEQ     .END
000011BA  3140 FFFE                343              MOVE.W  D0,-2(A0)
000011BE  4E75                     344  .END        RTS
000011C0                           345  
000011C0                           346  ; -----------------------------------------------------------------------------
000011C0                           347  DMMFREE
000011C0                           348  ; LIBERA EL SLOT A LA QUE PERTENECE EL PUNTERO PROPORCIONADO ESTABLECIENDO 
000011C0                           349  ; SU PROPIEDAD A SISTEMA (0)
000011C0                           350  ; ENTRADA  - A0   : PUNTERO PERTENECIENTE AL SLOT A LIBERAR
000011C0                           351  ; SALIDA   - NINGUNA
000011C0                           352  ; MODIFICA - NINGUNA
000011C0                           353  ; -----------------------------------------------------------------------------
000011C0  48E7 8080                354              MOVEM.L D0/A0,-(A7)
000011C4  2008                     355              MOVE.L  A0,D0
000011C6  C0BC FFFFFFC0            356              AND.L   #-DMMBSIZE,D0           ; APROVECHA LA ALINEACIÓN
000011CC  2040                     357              MOVE.L  D0,A0
000011CE  4250                     358              CLR.W   (A0)
000011D0  4CDF 0101                359              MOVEM.L (A7)+,D0/A0
000011D4  4E75                     360              RTS
000011D4  4E75                     361  -------------------- end include --------------------
000011D6                           362              INCLUDE "CONST.X68"             ; CONSTANTES DEL USUARIO
000011D6                           363  ; =============================================================================
000011D6                           364  ; CONSTANTES DEL SISTEMA
000011D6                           365  ; =============================================================================
000011D6                           366  
000011D6                           367  ; --- ESTADOS DEL JUEGO -------------------------------------------------------
000011D6                           368  
000011D6  =FFFFFFFF                369  STANONE     EQU     -1                      ; MARCADOR PARA FORZAR CAMBIO
000011D6  =00000000                370  STAINTR     EQU     0                       ; ESTADO DE INTRO/PRESIONAR DISPARO
000011D6  =00000001                371  STAPLAY     EQU     1                       ; ESTADO NORMAL DEL JUEGO
000011D6  =00000002                372  STAGOVR     EQU     2                       ; ESTADO DE JUEGO TERMINADO
000011D6                           373  
000011D6                           374  ; --- TIPOS DE AGENTES --------------------------------------------------------
000011D6                           375  
000011D6  =00000001                376  SHTTYPE     EQU     1
000011D6  =00000002                377  ASTTYPE     EQU     2
000011D6  =00000003                378  XPLTYPE     EQU     3
000011D6  =00000004                379  STRTYPE     EQU     4
000011D6                           380  
000011D6                           381  ; --- VALORES DE COLOR --------------------------------------------------------
000011D6                           382  
000011D6  =00000000                383  BLACK       EQU     $00000000
000011D6  =00000080                384  MAROON      EQU     $00000080
000011D6  =00008000                385  GREEN       EQU     $00008000
000011D6  =00008080                386  OLIVE       EQU     $00008080
000011D6  =00800000                387  NAVY        EQU     $00800000
000011D6  =00800080                388  PURPLE      EQU     $00800080
000011D6  =00808000                389  TEAL        EQU     $00808000
000011D6  =00808080                390  GRAY        EQU     $00808080
000011D6  =000000FF                391  RED         EQU     $000000FF
000011D6  =0000FF00                392  LIME        EQU     $0000FF00
000011D6  =0000FFFF                393  YELLOW      EQU     $0000FFFF
000011D6  =00FF0000                394  BLUE        EQU     $00FF0000
000011D6  =00FF00FF                395  FUCHSIA     EQU     $00FF00FF
000011D6  =00FFFF00                396  AQUA        EQU     $00FFFF00
000011D6  =00C0C0C0                397  LITGRAY     EQU     $00C0C0C0
000011D6  =0000C0FF                398  ORANGE      EQU     $0000C0FF
000011D6  =00FFFFFF                399  WHITE       EQU     $00FFFFFF
000011D6                           400  
000011D6                           401  ; --- CONSTANTES RELACIONADAS CON EL CORAZÓN ----------------------------------
000011D6                           402  
000011D6  =0000000F                403  HTBORDER    EQU     15                      ; BORDE DEL CORAZÓN
000011D6  =0000000E                404  HTHEIGH     EQU     14                      ; ALTURA DEL CORAZÓN
000011D6  =0000000F                405  HTWIDTH     EQU     15                      ; ANCHO DEL CORAZÓN
000011D6  =00000003                406  HTTILSIZ    EQU     3                       ; TAMAÑO DEL TILE DEL CORAZÓN
000011D6  =000000FF                407  HTTILCL1    EQU     RED                     ; COLOR 1 DEL TILE DEL CORAZÓN
000011D6  =00000000                408  HTTILCL2    EQU     BLACK                   ; COLOR 2 DEL TILE DEL CORAZÓN
000011D6  =00FFFFFF                409  HTTILCL3    EQU     WHITE                   ; COLOR 3 DEL TILE DEL CORAZÓN
000011D6                           410  
000011D6                           411  ; --- CONSTANTES RELACIONADAS CON EL JUGADOR ----------------------------------
000011D6                           412  
000011D6  =0000001E                413  PLRWIDTH    EQU     30                      ; ANCHO DEL JUGADOR(PIXELS)
000011D6  =0000000F                414  PLRHEIGH    EQU     15                      ; ALTURA DEL JUGADOR(PIXELS)                     
000011D6  =00000003                415  PLRINLIF    EQU     3                       ; VIDAS INICIALES DEL JUGADOR
000011D6  =00000005                416  PLRSPEED    EQU     5                       ; VELOCIDAD JUGADOR(PIXELS POR INT)
000011D6  =0000C0FF                417  PLRNRMCL    EQU     ORANGE                  ; COLOR NORMAL DEL JUGADOR
000011D6  =00000001                418  PLRUMDMG    EQU     %00000001               ; MÁSCARA DE ACTUALIZACIÓN DE DAÑO
000011D6  =00000002                419  PLRPMDMG    EQU     %00000010               ; MÁSCARA DE TRAZADO DE DAÑO
000011D6  =00000000                420  PLRUBDMG    EQU     0                       ; BIT DE ACTUALIZACIÓN DE DAÑO
000011D6  =00000001                421  PLRPBDMG    EQU     1                       ; BIT DE TRAZADO DE DAÑO
000011D6  =00FFFFFF                422  PLRTXTCL    EQU     WHITE                   ; COLOR DE LA FUENTE
000011D6  =00000002                423  PLRTXTX     EQU     2                       ; COORDENADA X DE LA PUNTUACIÓN
000011D6  =00000001                424  PLRTXTY     EQU     1                       ; COORDENADA Y DE LA PUNTUACIÓN
000011D6  =00000041                425  FPGTXTX     EQU     65                      ; FPS GOAL X COORDENADA
000011D6  =00000001                426  FPGTXTY     EQU     1                       ; FPS GOAL Y COORDENADA
000011D6  =0000003F                427  FPSTXTX     EQU     63                      ; COORDENADA X DE TIEMPO
000011D6  =00000002                428  FPSTXTY     EQU     2                       ; COORDENADA Y DE TIEMPO
000011D6  =0000001E                429  FPSGOAL     EQU     30                      ; FPS GOAL
000011D6                           430  
000011D6                           431  ; --- CONSTANTES RELACIONADAS CON EL DISPARO ----------------------------------
000011D6                           432  
000011D6  =00000014                433  SHTWIDTH    EQU     20                      ; ANCHO DEL DISPARO(PIXELS)
000011D6  =00000003                434  SHTHEIGH    EQU     3                       ; ALTURA DEL DISPARO. SOLO DIBUJAR.
000011D6  =FFFFFFF6                435  SHTSPEED    EQU     -10                     ; VELOCIDAD DISPARO(PIXELS POR INT)
000011D6                           436  
000011D6                           437  ; --- CONSTANTES SOBRE EL ENEMIGO ---------------------------------------------
000011D6                           438  
000011D6  =00000032                439  ENEWIDTH    EQU     50                      ; ANCHURA DEL ENEMIGO
000011D6  =0000001E                440  ENEHEIGH    EQU     30                      ; ALTURA DEL ENEMIGO
000011D6  =00FFFF00                441  ENECOL1     EQU     AQUA                    ; COLOR DEL BORDE DEL ASTEROIDE
000011D6  =0000FF00                442  ENECOL2     EQU     LIME                    ; COLOR DE RELLENO DEL ASTEROIDE
000011D6  =0000000A                443  ASTDMG      EQU     10                      ; DAÑO DEL ASTEROIDE AL JUGADOR
000011D6  =0000000A                444  ASTNFRAG    EQU     10                      ; NUMBER OF FRAGMENTS IN EXPLOSION
000011D6  =00000005                445  ASTSCORE    EQU     5                       ; SCORE ASTEROID DESTRUCTION
000011D6                           446  
000011D6                           447  ; --- CONSTANTES RELACIONADAS CON LA EXPLOSIÓN --------------------------------
000011D6                           448  
000011D6  =00000002                449  XPLSIZE     EQU     2                       ; DIAMETRO DE LA EXPLOSIÓN(PIXELS)
000011D6  =000000FF                450  XPLPENCL    EQU     RED                     ; COLOR DEL BORDE DE LA EXPLOSIÓN
000011D6  =000000FF                451  XPLFILCL    EQU     RED                     ; COLOR DEL RELLENO DE LA EXPLOSIÓN
000011D6                           452  
000011D6                           453  ; --- CONSTANTES RELACIONADAS CON LA ESTRELLA ---------------------------------
000011D6                           454  
000011D6  =00000002                455  SSTRSIZE    EQU     2                       ; DIÁMETRO ESTRELLA PEQUEÑA(PIXELS)
000011D6  =00000002                456  SSTRSPEED   EQU     2                       ; VELOCIDAD DE LA ESTRELLA PEQUEÑA
000011D6  =00000005                457  BSTRSIZE    EQU     5                       ; DIÁMETRO ESTRELLA GRANDE(PIXELS)
000011D6  =00000005                458  BSTRSPEED   EQU     5                       ; VELOCIDAD DE LA ESTRELLA GRANDE
000011D6                           459  
000011D6                           460  ; --- CONSTANTES RELACIONADAS CON EL ESTADO DE INTRODUCCIÓN -------------------
000011D6                           461  
000011D6  =0000001C                462  INTPRSX     EQU     28                      ; PRESS ANYTHING X COORDENADA
000011D6  =0000001F                463  INTPRSY     EQU     31                      ; PRESS ANYTHING Y COORDENADA
000011D6  =00FFFFFF                464  INTPRSC     EQU     WHITE                   ; PRESS ANITHING COLOR
000011D6                           465  
000011D6  =0000001E                466  TOPTXTX     EQU     30
000011D6  =00000013                467  TOPTXTY     EQU     19
000011D6  =00000022                468  TP1TXTX     EQU     34
000011D6  =00000015                469  TP1TXTY     EQU     21
000011D6  =00000022                470  TP2TXTX     EQU     34
000011D6  =00000017                471  TP2TXTY     EQU     23
000011D6  =00000022                472  TP3TXTX     EQU     34
000011D6  =00000019                473  TP3TXTY     EQU     25
000011D6                           474  
000011D6  =00000020                475  IMGINTSZ    EQU     32                      ; TAMAÑO EN TILES
000011D6  =00000008                476  IMGTILSZ    EQU     8                       ; TAMAÑO DE UN TILE EN PIXELES
000011D6                           477  
000011D6                           478  ; --- CONSTANTES RELACIONADAS CON EL ESTADO DE GAME OVER ----------------------
000011D6                           479  
000011D6  =00000023                480  GOVSTRX     EQU     35                      ; TITLE X COORDENADA
000011D6  =0000000F                481  GOVSTRY     EQU     15                      ; TITLE Y COORDENADA
000011D6  =00000021                482  GOVSCOX     EQU     33
000011D6  =00000014                483  GOVSCOY     EQU     20
000011D6  =0000001E                484  GOVNRX      EQU     30
000011D6  =00000018                485  GOVNRY      EQU     24
000011D6  =00FFFFFF                486  GOVSTRC     EQU     WHITE                   ; COLOR DEL TÍTULO
000011D6  =00000003                487  NUMSCOS     EQU     3                       ; Nº DE PUNTUACIONES QUE GUARDARA
000011D6= 44 41 54 41 2F 53 ...    488  FNAME       DC.B    'DATA/SCORES.DAT',0
000011E6                           489              DS.W    0
000011E6                           490  
000011E6                           491  ; --- CONSTANTES RELACIONADAS CON EL AUDIO ------------------------------------
000011E6                           492  
000011E6  =00000000                493  AUDINTID    EQU     0                       ; ID DE LA MÚSICA DE INTRO
000011E6  =00000001                494  AUDSHTID    EQU     1                       ; ID DEL SONIDO DE DISPARO
000011E6  =00000002                495  AUDIMPID    EQU     2                       ; ID DEL SONIDO DE IMPACTO
000011E6  =00000003                496  AUDHERID    EQU     3                       ; ID DEL SONIDO DE DAÑO
000011E6  =00000004                497  AUDGOVID    EQU     4                       ; ID DEL SONIDO DE GAME OVER
000011E6  =00000005                498  AUDCDNID    EQU     5                       ; ID DEL SONIDO DE COUNTDOWN
000011E6  =00000006                499  AUDCDFID    EQU     6                       ; ID DEL SONIDO FINAL DE COUNTDOWN
000011E6                           500  
000011E6  =000000FF                501  AUDENDID    EQU     $FF                     ; ID PARA DETENER TODOS LOS SONIDOS
000011E6  =00000080                502  AUDMSKLP    EQU     $80                     ; MÁSCARA DE AUDIO DE BUCLE
000011E6  =00000000                503  AUDMSKNL    EQU     $00                     ; MÁSCARA DE AUDIO SIN BUCLE
000011E6  =000000FF                504  AUDACCY     EQU     $FF                     ; ACEPTAR REPRODUC. DE NUEVO SONIDO
000011E6  =00000000                505  AUDACCN     EQU     $00                     ; NO REPRODUCIR NUEVO SONIDO
000011E6                           506  
000011E6                           507  ; --- CONSTANTES SOBRE LA CUENTA REGRESIVA ------------------------------------
000011E6                           508  
000011E6  =00000004                509  INITCR      EQU     4                       ; NUMERO DE VECES A CONTAR
000011E6  =0000012C                510  NUMHEIGH    EQU     300                     ; ALTURA DEL NUMERO
000011E6  =000000C8                511  NUMWIDTH    EQU     200                     ; ANCHURA DEL NUMERO
000011E6  =0000001E                512  NUMSIZE     EQU     30                      ; TAMAÑO DEL NUMERO
000011E6  =00FFFFFF                513  NUMCOLOR    EQU     WHITE                   ; COLOR DEL NUMERO 
000011E6                           514  
000011E6                           515  
000011E6                           516  
000011E6                           517  
000011E6                           518  
000011E6                           519  
000011E6                           520  
000011E6                           521  
000011E6                           522  
000011E6                           523  
000011E6                           524  
000011E6                           525  
000011E6                           526  
000011E6                           527  
000011E6                           528  
000011E6                           529  
000011E6                           530  
000011E6                           531  
000011E6                           532  
000011E6                           533  
000011E6                           534  
000011E6                           535  
000011E6                           536  
000011E6                           537  
000011E6                           538  
000011E6                           539  
000011E6                           540  
000011E6                           541  -------------------- end include --------------------
000011E6                           542              INCLUDE "UTIL.X68"              ; MACROS DE UTILIDAD Y SUBRUTINAS
000011E6                           543  ; =============================================================================
000011E6                           544  ; MACROS DE UTILIDAD
000011E6                           545  ; =============================================================================
000011E6                           546  
000011E6                           547  ; -----------------------------------------------------------------------------
000011E6                           548  UTLSPEN     MACRO
000011E6                           549  ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL LÁPIZ.
000011E6                           550  ; ENTRADA  - \1 COLOR EN FORMATO $00BBGGRR
000011E6                           551  ; SALIDA   - NINGUNA
000011E6                           552  ; MODIFICA - D0,D1
000011E6                           553  ; -----------------------------------------------------------------------------
000011E6                           554              MOVE.B  #80,D0
000011E6                           555              MOVE.L  \1,D1
000011E6                           556              TRAP    #15
000011E6                           557              ENDM
000011E6                           558  
000011E6                           559  ; -----------------------------------------------------------------------------
000011E6                           560  UTLSFIL     MACRO
000011E6                           561  ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
000011E6                           562  ; ENTRADA  - \1 COLOR EN FORMATO $00BBGGRR
000011E6                           563  ; SALIDA   - NINGUNA
000011E6                           564  ; MODIFICA - D0,D1
000011E6                           565  ; -----------------------------------------------------------------------------
000011E6                           566              MOVE.B  #81,D0
000011E6                           567              MOVE.L  \1,D1
000011E6                           568              TRAP    #15
000011E6                           569              ENDM
000011E6                           570  
000011E6                           571  ; -----------------------------------------------------------------------------
000011E6                           572  UTLLOCT     MACRO
000011E6                           573  ; ENVOLTORIO PARA LA POSICIONAMIENTO DE TEXTO DESDE TRAP 15
000011E6                           574  ; ENTRADA  - \1 X, \2 Y
000011E6                           575  ; SALIDA   - NINGUNA
000011E6                           576  ; MODIFICA - D0,D1
000011E6                           577  ; -----------------------------------------------------------------------------
000011E6                           578              MOVE.W  #\1<<8|\2, D1
000011E6                           579              MOVE.B  #11,D0
000011E6                           580              TRAP    #15
000011E6                           581              ENDM
000011E6                           582  
000011E6                           583  ; =============================================================================
000011E6                           584  ; SUBRUTINAS DE UTILIDAD
000011E6                           585  ; =============================================================================
000011E6                           586  
000011E6                           587  ; -----------------------------------------------------------------------------
000011E6                           588  UTLINIT
000011E6                           589  ; INICIALIZA EL CÓDIGO DE UTILIDAD
000011E6                           590  ; ENTRADA  - NINGUNA
000011E6                           591  ; SALIDA   - NINGUNA
000011E6                           592  ; MODIFICA - NINGUNA
000011E6                           593  ; -----------------------------------------------------------------------------
000011E6  4239 00003F5F            594              CLR.B   (UTLRNDIX)
000011EC  4E75                     595              RTS
000011EE                           596  ; -----------------------------------------------------------------------------
000011EE                           597  UTLCHCOL
000011EE                           598  ; VERIFICA LA COLISIÓN
000011EE                           599  ; ENTRADA  - D0.W COORDENADA X0
000011EE                           600  ;            D1.W COORDENADA Y0
000011EE                           601  ;            D2.W COORDENADA X1
000011EE                           602  ;            D3.W COORDENADA Y1
000011EE                           603  ;            D4.W ANCHO 0
000011EE                           604  ;            D5.W ANCHO 1
000011EE                           605  ;            D6.W ALTURA 0
000011EE                           606  ;            D7.W ALTURA 1
000011EE                           607  ; SALIDA   - D0.B=FF - COLISIÓN, =0 - NO COLISIÓN
000011EE                           608  ; MODIFICA - NINGUNA
000011EE                           609  ; -----------------------------------------------------------------------------
000011EE  48A7 0F00                610              MOVEM.W D4-D7,-(A7)
000011F2  D840                     611              ADD.W   D0,D4
000011F4  B842                     612              CMP.W   D2,D4
000011F6  6F00 0022                613              BLE     .NOCOL
000011FA  DA42                     614              ADD.W   D2,D5
000011FC  BA40                     615              CMP.W   D0,D5
000011FE  6F00 001A                616              BLE     .NOCOL
00001202  DC41                     617              ADD.W   D1,D6
00001204  BC43                     618              CMP.W   D3,D6
00001206  6F00 0012                619              BLE     .NOCOL
0000120A  DE43                     620              ADD.W   D3,D7
0000120C  BE41                     621              CMP.W   D1,D7
0000120E  6F00 000A                622              BLE     .NOCOL
00001212  103C 00FF                623              MOVE.B  #$FF,D0
00001216  6000 0004                624              BRA     .END
0000121A  4200                     625  .NOCOL      CLR.B   D0
0000121C  4C9F 00F0                626  .END        MOVEM.W (A7)+,D4-D7
00001220  4E75                     627              RTS
00001222                           628  
00001222                           629  ; -----------------------------------------------------------------------------
00001222                           630  UTLRAND
00001222                           631  ; PROPORCIONA UN BYTE PSEUDO-ALEATORIO
00001222                           632  ; ENTRADA  - NINGUNA
00001222                           633  ; SALIDA   - D0.L VALOR ALEATORIO (SOLO BYTE)
00001222                           634  ; MODIFICA - NINGUNA (APARTE DE LA SALIDA)
00001222                           635  ; -----------------------------------------------------------------------------
00001222  2F08                     636              MOVE.L  A0,-(A7)
00001224  41F9 00001240            637              LEA     .RANDVEC,A0
0000122A  4280                     638              CLR.L   D0
0000122C  1039 00003F5F            639              MOVE.B  (UTLRNDIX),D0
00001232  1030 0800                640              MOVE.B  (A0,D0.L),D0
00001236  5239 00003F5F            641              ADDQ.B  #1,(UTLRNDIX)
0000123C  205F                     642              MOVE.L  (A7)+,A0
0000123E  4E75                     643              RTS
00001240                           644  
00001240                           645  
00001240= A2 EE 9A 0C F5 24 ...    646  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00001248= 2A A3 51 26 E0 AC ...    647              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001250= 75 51 CA FD 33 EB ...    648              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001258= 60 CC E7 B8 9A EB ...    649              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001260= 1D 76 B5 95 B0 89 ...    650              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001268= 39 15 48 C9 6E CA ...    651              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001270= 43 E7 E2 7C 37 25 ...    652              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001278= E9 94 CE E9 E4 52 ...    653              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001280= 37 6D 9A 84 A2 28 ...    654              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001288= 19 E2 C6 77 80 D4 ...    655              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001290= 0A 5A 32 67 33 C2 ...    656              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001298= 59 80 DC 0E 57 FC ...    657              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
000012A0= 8A AB BC F7 07 4D ...    658              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000012A8= EF D5 77 6E 1E BB ...    659              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000012B0= D6 E0 2A 8F BD 28 ...    660              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000012B8= 13 4F 66 EC 0A 64 ...    661              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
000012C0= 56 52 9A 16 9B 90 ...    662              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
000012C8= 06 8A A4 F7 01 DA ...    663              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
000012D0= F2 E7 77 28 B1 76 ...    664              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
000012D8= A4 42 E3 81 B1 67 ...    665              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
000012E0= BF CE FA 16 BF 38 ...    666              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
000012E8= D1 8B 50 0C 5F 49 ...    667              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
000012F0= DE 4C 14 A2 40 DC ...    668              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
000012F8= B6 9B 0A 38 5D AB ...    669              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001300= E2 1B DD 75 15 82 ...    670              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001308= 8A 26 51 30 9F 47 ...    671              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001310= 1E 8A BB 71 C6 6E ...    672              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001318= 9F 47 E5 34 94 27 ...    673              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001320= 7D 06 D6 BA 30 0F ...    674              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001328= EC 7F 7E 03 CF 2D ...    675              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001330= 94 5B 23 F2 8B CD ...    676              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00001338= 74 33 EC B9 0F D5 ...    677              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001340                           678  
00001340                           679  
00001340                           680  
00001340                           681  
00001340                           682  
00001340                           683  
00001340                           684  -------------------- end include --------------------
00001340                           685              INCLUDE "PLAYER.X68"            ; GESTIÓN DEL JUGADOR
00001340                           686  ; =============================================================================
00001340                           687  ; GESTIÓN DEL JUGADOR
00001340                           688  ; =============================================================================
00001340                           689  
00001340                           690  ; -----------------------------------------------------------------------------
00001340                           691  PLRINIT
00001340                           692  ; INICIALIZA EL JUGADOR
00001340                           693  ; ENTRADA  - NINGUNA
00001340                           694  ; SALIDA   - NINGUNA
00001340                           695  ; MODIFICA - NINGUNA
00001340                           696  ; -----------------------------------------------------------------------------
00001340  33FC 0262 00003F52       697              MOVE.W  #SCRHEIGH-(PLRHEIGH*2),(PLRPOSY)
00001348  33FC 0131 00003F50       698              MOVE.W  #(SCRWIDTH-PLRWIDTH)/2,(PLRPOSX)
00001350  13FC 0003 00003F54       699              MOVE.B  #PLRINLIF,(PLRLIFES)
00001358  4279 00003F58            700              CLR.W   (PLRDMG)
0000135E  4239 00003F5E            701              CLR.B   (ASTMODE)
00001364  4279 00003F56            702              CLR.W   (PLRSCORE)
0000136A                           703                          
0000136A                           704              ; EMPIEZA CUENTA REGRESIVA
0000136A  4239 00003F5C            705              CLR.B   (CICLOCR)
00001370  13FC 0004 00003F5D       706              MOVE.B  #INITCR,(NUMACTCR)
00001378                           707              
00001378  13FC 00FF 00003F5A       708              MOVE.B  #AUDACCY,(AUDACCSN)     ; PERMITIR NUEVOS SONIDOS
00001380  123C 00FF                709              MOVE.B  #AUDENDID,D1            ; PARAR LA MÚSICA
00001384  4EB9 00002FDA            710              JSR     AUDPLAY
0000138A                           711                         
0000138A  4E75                     712              RTS
0000138C                           713  
0000138C                           714  ; -----------------------------------------------------------------------------
0000138C                           715  PLRUPD
0000138C                           716  ; ACTUALIZA EL MOVIMIENTO DEL JUGADOR
0000138C                           717  ; ENTRADA  - NINGUNA (ACCESO A KBDVAL Y KBDEDGE)
0000138C                           718  ; SALIDA   - NINGUNA (MODIFICA LOS DATOS DEL JUGADOR)
0000138C                           719  ; MODIFICA - NINGUNA
0000138C                           720  ; -----------------------------------------------------------------------------
0000138C  08B9 0000 00003F58       721              BCLR.B  #PLRUBDMG,(PLRDMG)
00001394  6700 002C                722              BEQ     .NODMG
00001398                           723                          
00001398  5339 00003F54            724              SUBQ.B   #1,(PLRLIFES)
0000139E  6E00 0018                725              BGT     .HER
000013A2                           726              
000013A2                           727              ; ACTIVAR MUSICA
000013A2  123C 0004                728              MOVE.B  #AUDMSKNL|AUDGOVID,D1
000013A6  4EB9 00002FDA            729              JSR     AUDPLAY                 ; REPRODUCIR MÚSICA
000013AC                           730              
000013AC                           731              ;JSR     SCOREC
000013AC  33FC 0002 00003F42       732              MOVE.W  #STAGOVR,(STANEXT)      ; SI LA VIDA ES 0, SE ACABÓ EL JUEGO
000013B4                           733              
000013B4  6000 000C                734              BRA     .NODMG
000013B8                           735  
000013B8                           736  .HER        ; ACTIVAR MUSICA
000013B8  123C 0003                737              MOVE.B  #AUDMSKNL|AUDHERID,D1
000013BC  4EB9 00002FDA            738              JSR     AUDPLAY                 ; REPRODUCIR MÚSICA
000013C2                           739              
000013C2  3F01                     740  .NODMG      MOVE.W  D1,-(A7)
000013C4                           741  
000013C4  1239 0000329E            742              MOVE.B  (KBDVAL),D1             ; PERFORM MOTION AND CHECK LIMITS.
000013CA                           743  
000013CA  E219                     744              ROR.B   #1,D1
000013CC  6400 0018                745              BCC     .CHKUP
000013D0  5B79 00003F50            746              SUB.W   #PLRSPEED,(PLRPOSX)
000013D6  4A79 00003F50            747              TST.W   (PLRPOSX)
000013DC  6C00 0008                748              BGE     .CHKUP
000013E0  4279 00003F50            749              CLR.W   (PLRPOSX)
000013E6  E219                     750  .CHKUP      ROR.B   #1,D1
000013E8  6400 0018                751              BCC     .CHKRT
000013EC  5B79 00003F52            752              SUB.W   #PLRSPEED,(PLRPOSY)
000013F2  4A79 00003F52            753              TST.W   (PLRPOSY)
000013F8  6C00 0008                754              BGE     .CHKRT
000013FC  4279 00003F52            755              CLR.W   (PLRPOSY)
00001402  E219                     756  .CHKRT      ROR.B   #1,D1
00001404  6400 001C                757              BCC     .CHKDN
00001408  5A79 00003F50            758              ADD.W   #PLRSPEED,(PLRPOSX)
0000140E  0C79 0262 00003F50       759              CMP.W   #(SCRWIDTH-PLRWIDTH),(PLRPOSX)
00001416  6F00 000A                760              BLE     .CHKDN
0000141A  33FC 0262 00003F50       761              MOVE.W  #(SCRWIDTH-PLRWIDTH),(PLRPOSX)
00001422  E219                     762  .CHKDN      ROR.B   #1,D1
00001424  6400 001C                763              BCC     .MDONE
00001428  5A79 00003F52            764              ADD.W   #PLRSPEED,(PLRPOSY)
0000142E  0C79 0271 00003F52       765              CMP.W   #SCRHEIGH-PLRHEIGH,(PLRPOSY)
00001436  6F00 000A                766              BLE     .MDONE
0000143A  33FC 0271 00003F52       767              MOVE.W  #SCRHEIGH-PLRHEIGH,(PLRPOSY)
00001442  0839 0004 0000329F       768  .MDONE      BTST.B  #KBDBITF1,(KBDEDGE)
0000144A  6700 0052                769              BEQ     .NOFIRE
0000144E                           770              
0000144E  4A39 00003F5D            771              TST.B   NUMACTCR                ; CR ES !0 -> NO PODEMOS DISPARAR
00001454  6600 0048                772              BNE     .NOFIRE
00001458                           773  
00001458  48E7 E070                774              MOVEM.L A1-A3/D0-D2,-(A7)
0000145C  43F9 00001720            775              LEA     SHTINIT,A1
00001462  45F9 0000173A            776              LEA     SHTUPD,A2
00001468  47F9 000017AE            777              LEA     SHTPLOT,A3
0000146E  303C 0001                778              MOVE.W  #SHTTYPE,D0
00001472  3239 00003F50            779              MOVE.W  (PLRPOSX),D1
00001478  3439 00003F52            780              MOVE.W  (PLRPOSY),D2
0000147E  4EB9 000016BC            781              JSR     AGLADD
00001484                           782              
00001484  3239 00003F50            783              MOVE.W  (PLRPOSX),D1
0000148A  0641 001B                784              ADD.W   #PLRWIDTH-SHTHEIGH,D1
0000148E  3439 00003F52            785              MOVE.W  (PLRPOSY),D2
00001494  4EB9 000016BC            786              JSR     AGLADD
0000149A  4CDF 0E07                787              MOVEM.L (A7)+,A1-A3/D0-D2
0000149E                           788              
0000149E  4A39 00003F5D            789  .NOFIRE     TST.B   NUMACTCR                ; CR ES 0 -> PODEMOS SALTAR
000014A4  6700 0008                790              BEQ     .END
000014A8  4EB9 00003012            791              JSR     CUREUPD                 ; ACTUALIZA CUENTA REGRESIVA
000014AE                           792              
000014AE  321F                     793  .END        MOVE.W  (A7)+,D1
000014B0  4E75                     794              RTS
000014B2                           795  
000014B2                           796  ; -----------------------------------------------------------------------------
000014B2                           797  PLRPLOT
000014B2                           798  ; TRAZA EL JUGADOR, SU VIDA Y LA PUNTUACIÓN
000014B2                           799  ; ENTRADA  - NINGUNA
000014B2                           800  ; SALIDA   - NINGUNA
000014B2                           801  ; MODIFICA - NINGUNA
000014B2                           802  ; -----------------------------------------------------------------------------
000014B2  48E7 FF00                803              MOVEM.L D0-D7,-(A7)
000014B6                           804                       
000014B6  223C 0000C0FF            805              MOVE.L  #PLRNRMCL,D1            ; DECIDE COLOR
000014BC                           806              
000014BC  103C 0050                807              MOVE.B  #80,D0
000014C0  4E4F                     808              TRAP    #15
000014C2  5200                     809              ADDQ.B  #1,D0
000014C4  4E4F                     810              TRAP    #15
000014C6                           811              
000014C6  3239 00003F50            812              MOVE.W  (PLRPOSX),D1            ; TRAZAR EL JUGADOR
000014CC  3439 00003F52            813              MOVE.W  (PLRPOSY),D2
000014D2  3601                     814              MOVE.W  D1,D3
000014D4  3802                     815              MOVE.W  D2,D4
000014D6  0643 001E                816              ADD.W   #PLRWIDTH,D3
000014DA  0644 000F                817              ADD.W   #PLRHEIGH,D4
000014DE  103C 0058                818              MOVE.B  #88,D0
000014E2  4E4F                     819              TRAP    #15
000014E4                           820              
000014E4  5742                     821              SUBQ.W  #3,D2
000014E6  0443 001B                822              SUB.W   #PLRWIDTH-3,D3
000014EA  5F44                     823              SUB.W   #PLRHEIGH/2,D4
000014EC  103C 0057                824              MOVE.B  #87,D0
000014F0  4E4F                     825              TRAP    #15
000014F2                           826              
000014F2  0641 001B                827              ADD.W   #PLRWIDTH-3,D1
000014F6  0643 001B                828              ADD.W   #PLRWIDTH-3,D3
000014FA  4E4F                     829              TRAP    #15  
000014FC                           830              
000014FC  3239 00003F50            831              MOVE.W  (PLRPOSX),D1
00001502  0641 000A                832              ADD.W   #(PLRWIDTH/2)-5,D1
00001506  3601                     833              MOVE.W  D1,D3
00001508  0643 000B                834              ADD.W   #PLRHEIGH-4,D3
0000150C  3439 00003F52            835              MOVE.W  (PLRPOSY),D2
00001512  3802                     836              MOVE.W  D2,D4
00001514  0644 0012                837              ADD.W   #PLRHEIGH+3,D4
00001518  0642 000A                838              ADD.W   #10,D2
0000151C  4E4F                     839              TRAP    #15
0000151E                           840              
0000151E  2F01                     841              MOVE.L  D1,-(A7)
00001520  223C 000000FF            842              MOVE.L  #RED,D1
00001526  103C 0050                843              MOVE.B  #80,D0
0000152A  4E4F                     844              TRAP    #15
0000152C  5200                     845              ADDQ.B  #1,D0
0000152E  4E4F                     846              TRAP    #15
00001530  221F                     847              MOVE.L  (A7)+,D1
00001532                           848              
00001532  3404                     849              MOVE.W  D4,D2
00001534  5244                     850              ADDQ.W  #1,D4
00001536  103C 0057                851              MOVE.B  #87,D0
0000153A  4E4F                     852              TRAP    #15        
0000153C                           853  
0000153C                           854m             UTLSPEN #PLRTXTCL               ; TRAZAR EL TEXTO SCORE
0000153C                           855m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL LÁPIZ.
0000153C                           856m ; ENTRADA  - #PLRTXTCL COLOR EN FORMATO $00BBGGRR
0000153C                           857m ; SALIDA   - NINGUNA
0000153C                           858m ; MODIFICA - D0,D1
0000153C                           859m ; -----------------------------------------------------------------------------
00001548                           860m             UTLSFIL #$00000000
00001548                           861m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
00001548                           862m ; ENTRADA  - #$00000000 COLOR EN FORMATO $00BBGGRR
00001548                           863m ; SALIDA   - NINGUNA
00001548                           864m ; MODIFICA - D0,D1
00001548                           865m ; -----------------------------------------------------------------------------
00001550                           866m             UTLLOCT PLRTXTX,PLRTXTY
00001550                           867m ; ENVOLTORIO PARA LA POSICIONAMIENTO DE TEXTO DESDE TRAP 15
00001550                           868m ; ENTRADA  - PLRTXTX X, PLRTXTY Y
00001550                           869m ; SALIDA   - NINGUNA
00001550                           870m ; MODIFICA - D0,D1
00001550                           871m ; -----------------------------------------------------------------------------
0000155A  43F9 0000169C            872              LEA     .SCORESTR,A1
00001560  4281                     873              CLR.L   D1
00001562  3239 00003F56            874              MOVE.W  (PLRSCORE),D1
00001568  103C 0011                875              MOVE.B  #17,D0
0000156C  4E4F                     876              TRAP    #15
0000156E                           877              
0000156E                           878m             UTLSPEN #PLRTXTCL               ; TRAZAR EL TEXTO FPS GOAL
0000156E                           879m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL LÁPIZ.
0000156E                           880m ; ENTRADA  - #PLRTXTCL COLOR EN FORMATO $00BBGGRR
0000156E                           881m ; SALIDA   - NINGUNA
0000156E                           882m ; MODIFICA - D0,D1
0000156E                           883m ; -----------------------------------------------------------------------------
0000157A                           884m             UTLSFIL #$00000000
0000157A                           885m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
0000157A                           886m ; ENTRADA  - #$00000000 COLOR EN FORMATO $00BBGGRR
0000157A                           887m ; SALIDA   - NINGUNA
0000157A                           888m ; MODIFICA - D0,D1
0000157A                           889m ; -----------------------------------------------------------------------------
00001582                           890m             UTLLOCT FPGTXTX,FPGTXTY
00001582                           891m ; ENVOLTORIO PARA LA POSICIONAMIENTO DE TEXTO DESDE TRAP 15
00001582                           892m ; ENTRADA  - FPGTXTX X, FPGTXTY Y
00001582                           893m ; SALIDA   - NINGUNA
00001582                           894m ; MODIFICA - D0,D1
00001582                           895m ; -----------------------------------------------------------------------------
0000158C  43F9 000016A4            896              LEA     .FPSGSTR,A1
00001592  4281                     897              CLR.L   D1 
00001594  123C 001E                898              MOVE.B  #FPSGOAL,D1
00001598  103C 0011                899              MOVE.B  #17,D0
0000159C  4E4F                     900              TRAP    #15
0000159E                           901              
0000159E                           902m             UTLSPEN #PLRTXTCL               ; TRAZAR EL TEXTO FPS ACTUAL
0000159E                           903m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL LÁPIZ.
0000159E                           904m ; ENTRADA  - #PLRTXTCL COLOR EN FORMATO $00BBGGRR
0000159E                           905m ; SALIDA   - NINGUNA
0000159E                           906m ; MODIFICA - D0,D1
0000159E                           907m ; -----------------------------------------------------------------------------
000015AA                           908m             UTLSFIL #$00000000
000015AA                           909m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
000015AA                           910m ; ENTRADA  - #$00000000 COLOR EN FORMATO $00BBGGRR
000015AA                           911m ; SALIDA   - NINGUNA
000015AA                           912m ; MODIFICA - D0,D1
000015AA                           913m ; -----------------------------------------------------------------------------
000015B2                           914m             UTLLOCT FPSTXTX,FPSTXTY
000015B2                           915m ; ENVOLTORIO PARA LA POSICIONAMIENTO DE TEXTO DESDE TRAP 15
000015B2                           916m ; ENTRADA  - FPSTXTX X, FPSTXTY Y
000015B2                           917m ; SALIDA   - NINGUNA
000015B2                           918m ; MODIFICA - D0,D1
000015B2                           919m ; -----------------------------------------------------------------------------
000015BC  43F9 000016AF            920              LEA     .FPSSTR,A1
000015C2  4281                     921              CLR.L   D1
000015C4  2239 00003F44            922              MOVE.L  (FPSREAL),D1
000015CA  103C 0011                923              MOVE.B  #17,D0
000015CE  4E4F                     924              TRAP    #15
000015D0                           925  
000015D0                           926              ; ----- TRAZAR VIDA -----
000015D0                           927              ; INICIALIZAMOS A BAJO DEL TODO
000015D0  323C 0253                928              MOVE.W  #SCRWIDTH-(HTWIDTH*HTTILSIZ),D1
000015D4  343C 0280                929              MOVE.W  #SCRHEIGH,D2
000015D8  3601                     930              MOVE.W  D1,D3
000015DA  5843                     931              ADD.W   #HTTILSIZ+1,D3
000015DC  3802                     932              MOVE.W  D2,D4
000015DE  5544                     933              SUB.W   #HTTILSIZ-1,D4
000015E0                           934              
000015E0  4280                     935              CLR.L   D0                      ; UTILIZAMOS A1 PORQUE TODOS LOS
000015E2  1039 00003F54            936              MOVE.B  (PLRLIFES),D0           ; REGISTROS DX SE UTILIZARAN 
000015E8  5200                     937              ADDQ.B  #1,D0                   ; A CONTINUACIÓN
000015EA                           938              
000015EA  2F00                     939              MOVE.L  D0,-(A7)
000015EC                           940              
000015EC  201F                     941  .PRHT       MOVE.L  (A7)+,D0
000015EE  5300                     942              SUBQ.B  #1,D0
000015F0  4A00                     943              TST.B   D0
000015F2  6700 00A2                944              BEQ     .END                    ; HEMOS TERMINADO
000015F6                           945              
000015F6  2F00                     946              MOVE.L  D0,-(A7)
000015F8  41F9 00001E34            947              LEA     HEART,A0
000015FE  4285                     948              CLR.L   D5                      ; COLUMNAS
00001600  4286                     949              CLR.L   D6                      ; FILAS
00001602                           950                         
00001602  0441 000F                951              SUB.W  #HTBORDER,D1
00001606  0442 000F                952              SUB.W  #HTBORDER,D2
0000160A  0444 000F                953              SUB.W  #HTBORDER,D4
0000160E                           954              
0000160E                           955              ; PINTAMOS CORAZÓN
0000160E  4280                     956  .LOOP       CLR.L   D0
00001610  1018                     957              MOVE.B  (A0)+,D0                ; GUARDAMOS DATO
00001612                           958              
00001612  BA7C 000E                959              CMP.W   #HTWIDTH-1, D5          ; HEMOS LLEGADO AL LATERAL
00001616  6700 0062                960              BEQ     .ALTURA
0000161A                           961              
0000161A  4287                     962              CLR.L   D7
0000161C  3E01                     963              MOVE.W  D1,D7                   ; GUARDAMOS EN REGISTRO AUXILIAR
0000161E                           964              
0000161E  4A00                     965              TST.B   D0                      ; 0 -> NO PINTAR
00001620  6700 0050                966              BEQ     .MOVE
00001624                           967              
00001624  B03C 0001                968              CMP.B   #1,D0                   ; 1 -> ROJO
00001628  6600 0016                969              BNE     .NEGRO
0000162C  223C 000000FF            970              MOVE.L  #RED,D1
00001632  303C 0050                971              MOVE.W  #80,D0
00001636  4E4F                     972              TRAP    #15
00001638  5200                     973              ADDQ.B  #1,D0
0000163A  4E4F                     974              TRAP    #15
0000163C  6000 002A                975              BRA     .PINTAR
00001640                           976              
00001640  B03C 0002                977  .NEGRO      CMP.B   #2,D0                   ; 2 -> NEGRO
00001644  6600 0012                978              BNE     .BLANCO
00001648  7200                     979              MOVE.L  #BLACK,D1
0000164A  303C 0050                980              MOVE.W  #80,D0
0000164E  4E4F                     981              TRAP    #15
00001650  5200                     982              ADDQ.B  #1,D0
00001652  4E4F                     983              TRAP    #15
00001654  6000 0012                984              BRA     .PINTAR
00001658                           985              
00001658  223C 00FFFFFF            986  .BLANCO     MOVE.L  #WHITE,D1               ; 3 -> BLANCO
0000165E  303C 0050                987              MOVE.W  #80,D0
00001662  4E4F                     988              TRAP    #15
00001664  5200                     989              ADDQ.B  #1,D0
00001666  4E4F                     990              TRAP    #15
00001668                           991  
00001668                           992              
00001668                           993              
00001668  4281                     994  .PINTAR     CLR.L   D1
0000166A  3207                     995              MOVE.W  D7,D1                   ; DEVOLVEMOS AUXILIAR
0000166C  303C 0057                996              MOVE.W  #87,D0                  ; PINTAMOS
00001670  4E4F                     997              TRAP    #15                 
00001672                           998                         
00001672  5245                     999  .MOVE       ADDQ.W  #1,D5                   ; SUMAMOS COLUMNA
00001674  5641                    1000              ADD.W   #HTTILSIZ,D1
00001676  5643                    1001              ADD.W   #HTTILSIZ,D3
00001678  6094                    1002              BRA     .LOOP
0000167A                          1003              
0000167A                          1004  
0000167A  BC7C 000D               1005  .ALTURA     CMP.W   #HTHEIGH-1,D6           ; HEMOS ACABADO
0000167E  6700 FF6C               1006              BEQ     .PRHT
00001682                          1007              
00001682  5246                    1008              ADDQ.W  #1,D6                   ; SUMAMOS FILA
00001684  5742                    1009              SUB.W   #HTTILSIZ,D2
00001686  5744                    1010              SUB.W   #HTTILSIZ,D4
00001688                          1011              
00001688                          1012              
00001688  4285                    1013              CLR.L   D5
0000168A  323C 0244               1014              MOVE.W  #SCRWIDTH-(HTWIDTH*HTTILSIZ)-HTBORDER,D1 ;INIT FILA
0000168E  3601                    1015              MOVE.W  D1,D3
00001690  5843                    1016              ADD.W   #HTTILSIZ+1,D3
00001692  6000 FF7A               1017              BRA     .LOOP
00001696                          1018  
00001696                          1019                          
00001696  4CDF 00FF               1020  .END        MOVEM.L (A7)+,D0-D7
0000169A  4E75                    1021              RTS
0000169C                          1022              
0000169C                          1023              
0000169C= 53 43 4F 52 45 3A ...   1024  .SCORESTR   DC.B    'SCORE: ',0
000016A4= 46 50 53 20 47 4F ...   1025  .FPSGSTR    DC.B    'FPS GOAL: ',0
000016AF= 46 50 53 20 41 43 ...   1026  .FPSSTR     DC.B    'FPS ACTUAL: ',0
000016BC                          1027  
000016BC                          1028  
000016BC                          1029  -------------------- end include --------------------
000016BC                          1030              INCLUDE "AGENTLST.X68"          ; GESTIÓN DE LA LISTA DE AGENTES
000016BC                          1031  ; =============================================================================
000016BC                          1032  ; GESTIÓN DE AGENTES
000016BC                          1033  ; CADA AGENTE TIENE UN BLOQUE DE DATOS DE DMM COMO SIGUE:
000016BC                          1034  ; +0 - LONG : PUNTERO A LA SUBRUTINA DE ACTUALIZACIÓN
000016BC                          1035  ; +4 - LONG : PUNTERO A LA SUBRUTINA DE TRAZADO
000016BC                          1036  ; +8:FIN    : DATOS (ESPECÍFICOS DEL AGENTE)
000016BC                          1037  ; =============================================================================
000016BC                          1038  
000016BC                          1039  ; -----------------------------------------------------------------------------
000016BC                          1040  AGLADD
000016BC                          1041  ; CREA UN NUEVO AGENTE
000016BC                          1042  ; ENTRADA  - A1 - PUNTERO A LA FUNCIÓN DE INICIALIZACIÓN DEL AGENTE
000016BC                          1043  ;            A2 - PUNTERO A LA FUNCIÓN DE ACTUALIZACIÓN DEL AGENTE
000016BC                          1044  ;            A3 - PUNTERO A LA FUNCIÓN DE TRAZADO DEL AGENTE
000016BC                          1045  ;            D0 - TIPO DE AGENTE (UTILIZADO COMO PROPIEDAD POR DMM)
000016BC                          1046  ;            D1 - PARÁMETRO DE INICIALIZACIÓN DEL AGENTE 1
000016BC                          1047  ;            D2 - PARÁMETRO DE INICIALIZACIÓN DEL AGENTE 2
000016BC                          1048  ;            D3 - PARÁMETRO DE INICIALIZACIÓN DEL AGENTE 3
000016BC                          1049  ; SALIDA   - NINGUNA
000016BC                          1050  ; MODIFICA - NINGUNA
000016BC                          1051  ; -----------------------------------------------------------------------------
000016BC  2F08                    1052              MOVE.L  A0,-(A7)
000016BE  4EB8 11A6               1053              JSR     DMMALLOC
000016C2  B1FC 00000000           1054              CMP.L   #0,A0
000016C8  6700 0008               1055              BEQ     .END
000016CC  20CA                    1056              MOVE.L  A2,(A0)+
000016CE  20CB                    1057              MOVE.L  A3,(A0)+
000016D0  4E91                    1058              JSR     (A1)
000016D2  205F                    1059  .END        MOVE.L  (A7)+,A0
000016D4  4E75                    1060              RTS
000016D6                          1061  
000016D6                          1062  ; -----------------------------------------------------------------------------
000016D6                          1063  AGLUPD
000016D6                          1064  ; ACTUALIZA LA LISTA DE AGENTES. ANTES DE LLAMAR A LAS FUNCIONES DE 
000016D6                          1065  ; ACTUALIZACIÓN, A0 SE ESTABLECE AL BLOQUE DE DATOS DEL SLOT CORRESPONDIENTE.
000016D6                          1066  ; ENTRADA  - NINGUNA
000016D6                          1067  ; SALIDA   - NINGUNA
000016D6                          1068  ; MODIFICA - NINGUNA
000016D6                          1069  ; -----------------------------------------------------------------------------
000016D6  48E7 00C0               1070              MOVEM.L A0-A1,-(A7)
000016DA  4EB8 1136               1071              JSR     DMMFIRST
000016DE  B1FC 00000000           1072  .LOOP       CMP.L   #0,A0
000016E4  6700 000E               1073              BEQ     .END
000016E8  2250                    1074              MOVE.L  (A0),A1
000016EA  5088                    1075              ADD.L   #8,A0
000016EC  4E91                    1076              JSR     (A1)
000016EE  4EB8 1158               1077              JSR     DMMNEXT
000016F2  60EA                    1078              BRA     .LOOP
000016F4  4CDF 0300               1079  .END        MOVEM.L (A7)+,A0-A1
000016F8  4E75                    1080              RTS
000016FA                          1081  
000016FA                          1082  ; -----------------------------------------------------------------------------
000016FA                          1083  AGLPLOT
000016FA                          1084  ; TRAZA LA LISTA DE AGENTES. ANTES DE LLAMAR A LAS FUNCIONES DE ACTUALIZACIÓN,
000016FA                          1085  ; A0 SE ESTABLECE AL BLOQUE DE DATOS DEL SLOT CORRESPONDIENTE.
000016FA                          1086  ; ENTRADA  - NINGUNA
000016FA                          1087  ; SALIDA   - NINGUNA
000016FA                          1088  ; MODIFICA - NINGUNA
000016FA                          1089  ; -----------------------------------------------------------------------------
000016FA  48E7 00C0               1090              MOVEM.L A0-A1,-(A7)
000016FE  4EB8 1136               1091              JSR     DMMFIRST
00001702  B1FC 00000000           1092  .LOOP       CMP.L   #0,A0
00001708  6700 0010               1093              BEQ     .END
0000170C  2268 0004               1094              MOVE.L  4(A0),A1
00001710  5088                    1095              ADD.L   #8,A0
00001712  4E91                    1096              JSR     (A1)
00001714  4EB8 1158               1097              JSR     DMMNEXT
00001718  60E8                    1098              BRA     .LOOP
0000171A  4CDF 0300               1099  .END        MOVEM.L (A7)+,A0-A1
0000171E  4E75                    1100              RTS
00001720                          1101  
00001720                          1102  ; -----------------------------------------------------------------------------
00001720  =000011C0               1103  AGLKILL     EQU     DMMFREE
00001720                          1104  ; MATA AL AGENTE LIBERANDO SU MEMORIA
00001720                          1105  ; ENTRADA  - A0 PUNTERO DENTRO DE LA MEMORIA DEL AGENTE
00001720                          1106  ; SALIDA   - NINGUNA
00001720                          1107  ; MODIFICA - NINGUNA
00001720                          1108  ; NOTA     - ES SOLO UN ENVOLTORIO PARA DMMFREE
00001720                          1109  ; -----------------------------------------------------------------------------
00001720                          1110  
00001720                          1111  
00001720                          1112  
00001720                          1113  -------------------- end include --------------------
00001720                          1114              INCLUDE "SHOT.X68"              ; GESTIÓN DEL AGENTE DE DISPARO
00001720                          1115  ; =============================================================================
00001720                          1116  ; GESTIÓN DE DISPAROS. ES UN AGENTE.
00001720                          1117  ; LA MEMORIA LOCAL ES:
00001720                          1118  ; +0 PALABRA COORDENADA X
00001720                          1119  ; +2 PALABRA COORDENADA Y
00001720                          1120  ; =============================================================================
00001720                          1121  
00001720                          1122  ; -----------------------------------------------------------------------------
00001720                          1123  SHTINIT
00001720                          1124  ; INICIALIZA UN DISPARO
00001720                          1125  ; ENTRADA  - A0 PUNTERO A LA MEMORIA LOCAL
00001720                          1126  ;            D1.W COORDENADA X INICIAL
00001720                          1127  ;            D2.W COORDENADA Y INICIAL
00001720                          1128  ; SALIDA   - NINGUNA
00001720                          1129  ; MODIFICA - NINGUNA
00001720                          1130  ; -----------------------------------------------------------------------------
00001720                          1131              
00001720  3081                    1132              MOVE.W  D1,(A0)
00001722  3142 0002               1133              MOVE.W  D2,2(A0)
00001726                          1134              
00001726                          1135              ; ACTIVAR MUSICA
00001726  123C 0001               1136              MOVE.B  #AUDMSKNL|AUDSHTID,D1
0000172A  4EB9 00002FDA           1137              JSR     AUDPLAY                 ; REPRODUCIR MUSICA
00001730  13FC 00FF 00003F5A      1138              MOVE.B  #AUDACCY,(AUDACCSN)     ; RECHAZAR EFECTOS DE SONIDO
00001738                          1139                          
00001738  4E75                    1140              RTS
0000173A                          1141  
0000173A                          1142  ; -----------------------------------------------------------------------------
0000173A                          1143  SHTUPD
0000173A                          1144  ; ACTUALIZA UN DISPARO MOVIÉNDOLO HACIA LA DERECHA.
0000173A                          1145  ; ENTRADA  - A0 PUNTERO A LA MEMORIA LOCAL
0000173A                          1146  ; SALIDA   - NINGUNA
0000173A                          1147  ; MODIFICA - NINGUNA
0000173A                          1148  ; -----------------------------------------------------------------------------
0000173A  0668 FFF6 0002          1149              ADD.W   #SHTSPEED,2(A0)          ; MOVER
00001740                          1150              
00001740                          1151              ; COMPROBAR COLISIONES
00001740  4A68 0002               1152              TST.W   2(A0)
00001744  6F00 FA7A               1153              BLE     AGLKILL
00001748                          1154              
00001748  48E7 FFC0               1155              MOVEM.L A0-A1/D0-D7,-(A7)
0000174C                          1156              
0000174C  3410                    1157              MOVE.W  (A0),D2                 ; PREPARAR COORDENADAS DE DISPARO
0000174E  3628 0002               1158              MOVE.W  2(A0),D3                ; PARA VERIFICACIÓN DE COLISIÓN
00001752  3A3C 0014               1159              MOVE.W  #SHTWIDTH,D5
00001756  3E3C 000F               1160              MOVE.W  #PLRHEIGH,D7
0000175A  2248                    1161              MOVE.L  A0,A1
0000175C  303C 0002               1162              MOVE.W  #ASTTYPE,D0             ; RECORRER TODOS LOS ASTEROIDES
00001760  4EB8 116E               1163              JSR     DMMFRSTO
00001764  B1FC 00000000           1164  .LOOP       CMP.L   #0,A0
0000176A  6700 0026               1165              BEQ     .END
0000176E  3028 0008               1166              MOVE.W  8(A0),D0
00001772  3228 000A               1167              MOVE.W  10(A0),D1
00001776  383C 0032               1168              MOVE.W  #ENEWIDTH,D4
0000177A  3C3C 001E               1169              MOVE.W  #ENEHEIGH,D6
0000177E  4EB8 11EE               1170              JSR     UTLCHCOL
00001782  4A00                    1171              TST.B   D0
00001784  6600 0012               1172              BNE     .EXPLO                  ; SI HAY COLISIÓN, EXPLOSIONAR
00001788  303C 0002               1173              MOVE.W  #ASTTYPE,D0
0000178C  4EB8 1190               1174              JSR     DMMNEXTO
00001790  60D2                    1175              BRA     .LOOP
00001792                          1176              
00001792  4CDF 03FF               1177  .END        MOVEM.L (A7)+,A0-A1/D0-D7
00001796  4E75                    1178              RTS
00001798                          1179              
00001798  5088                    1180  .EXPLO      ADD.L   #8,A0
0000179A  4EB9 000018EA           1181              JSR     ENEXPLO                 ; EXPLOSIONAR ENEMIGO
000017A0  2049                    1182              MOVE.L  A1,A0
000017A2  4EB8 11C0               1183              JSR     AGLKILL                 ; DESTRUIR DISPARO
000017A6  5A79 00003F56           1184              ADD.W   #ASTSCORE,(PLRSCORE)    ; AUMENTAR PUNTUACIÓN
000017AC  60E4                    1185              BRA     .END
000017AE                          1186  
000017AE                          1187  ; -----------------------------------------------------------------------------
000017AE                          1188  SHTPLOT
000017AE                          1189  ; TRAZA EL DISPARO.
000017AE                          1190  ; ENTRADA  - A0 PUNTERO A LA MEMORIA LOCAL
000017AE                          1191  ; SALIDA   - NINGUNA
000017AE                          1192  ; MODIFICA - NINGUNA
000017AE                          1193  ; -----------------------------------------------------------------------------
000017AE  48E7 7880               1194              MOVEM.L     A0/D1-D4,-(A7)
000017B2                          1195m             UTLSPEN     #$00FF0000
000017B2                          1196m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL LÁPIZ.
000017B2                          1197m ; ENTRADA  - #$00FF0000 COLOR EN FORMATO $00BBGGRR
000017B2                          1198m ; SALIDA   - NINGUNA
000017B2                          1199m ; MODIFICA - D0,D1
000017B2                          1200m ; -----------------------------------------------------------------------------
000017BE                          1201m             UTLSFIL     #$00FF0000
000017BE                          1202m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
000017BE                          1203m ; ENTRADA  - #$00FF0000 COLOR EN FORMATO $00BBGGRR
000017BE                          1204m ; SALIDA   - NINGUNA
000017BE                          1205m ; MODIFICA - D0,D1
000017BE                          1206m ; -----------------------------------------------------------------------------
000017CA                          1207              
000017CA  3218                    1208              MOVE.W      (A0)+,D1
000017CC  3810                    1209              MOVE.W      (A0),D4
000017CE  3601                    1210              MOVE.W      D1,D3
000017D0  3404                    1211              MOVE.W      D4,D2
000017D2  5643                    1212              ADD.W       #SHTHEIGH,D3
000017D4  0642 0014               1213              ADD.W       #SHTWIDTH,D2
000017D8  103C 0057               1214              MOVE.B      #87,D0
000017DC  4E4F                    1215              TRAP        #15
000017DE                          1216                                      
000017DE  4CDF 011E               1217              MOVEM.L     (A7)+,A0/D1-D4
000017E2  4E75                    1218              RTS
000017E2  4E75                    1219  -------------------- end include --------------------
000017E4                          1220              INCLUDE "ENEMIGO.X68"           ; GESTIÓN DEL AGENTE ASTEROIDE
000017E4                          1221  ; =============================================================================
000017E4                          1222  ; GESTIÓN DE ASTEROIDES. ES UN AGENTE.
000017E4                          1223  ; LA MEMORIA LOCAL ES:
000017E4                          1224  ; +0 PALABRA COORDENADA X
000017E4                          1225  ; +2 PALABRA COORDENADA Y
000017E4                          1226  ; +4 PALABRA VELOCIDAD X
000017E4                          1227  ; +6 PALABRA VELOCIDAD Y
000017E4                          1228  ; =============================================================================
000017E4                          1229  
000017E4                          1230  ; -----------------------------------------------------------------------------
000017E4                          1231  ENEINIT
000017E4                          1232  ; INICIALIZA UN ASTEROIDE
000017E4                          1233  ; ENTRADA  - A0 PUNTERO A LA MEMORIA LOCAL
000017E4                          1234  ; SALIDA   - NINGUNA
000017E4                          1235  ; MODIFICA - NINGUNA
000017E4                          1236  ; NOTA     - ASUME QUE SCRHEIGH ES MAYOR QUE 255
000017E4                          1237  ; -----------------------------------------------------------------------------
000017E4  3F00                    1238              MOVE.W  D0,-(A7)
000017E6                          1239              
000017E6  4EB8 1222               1240              JSR     UTLRAND
000017EA  0640 00A7               1241              ADD.W   #(SCRWIDTH-255-ENEWIDTH)/2, D0
000017EE                          1242              
000017EE  3080                    1243              MOVE.W  D0,(A0)                 ; POSICIÓN X (PSEUDO-ALEATORIA)
000017F0  4268 0002               1244              CLR.W   2(A0)                   ; POSICIÓN Y 
000017F4                          1245              
000017F4  4EB8 1222               1246              JSR     UTLRAND
000017F8  C07C 000F               1247              AND.W   #$000F,D0               
000017FC  3140 0006               1248              MOVE.W  D0,6(A0)                ; VELOCIDAD Y (PSEUDO-ALEATORIA)
00001800                          1249              
00001800  0440 000A               1250              SUB.W  #10,D0
00001804  3140 0004               1251              MOVE.W  D0,4(A0)                ; VELOCIDAD X (PSEUDO-ALEATORIA)
00001808                          1252              
00001808  301F                    1253              MOVE.W  (A7)+,D0
0000180A  4E75                    1254              RTS
0000180C                          1255              
0000180C                          1256  ; -----------------------------------------------------------------------------
0000180C                          1257  ENEUPD
0000180C                          1258  ; ACTUALIZA UN ASTEROIDE
0000180C                          1259  ; ENTRADA  - A0 PUNTERO A LA MEMORIA LOCAL
0000180C                          1260  ; SALIDA   - NINGUNA
0000180C                          1261  ; MODIFICA - NINGUNA
0000180C                          1262  ; -----------------------------------------------------------------------------
0000180C  3F00                    1263              MOVE.W  D0,-(A7)
0000180E                          1264              
0000180E  3028 0004               1265              MOVE.W  4(A0),D0                ; ACTUALIZAMOS COORDENADAS
00001812  9150                    1266              SUB.W   D0,(A0)
00001814  3028 0006               1267              MOVE.W  6(A0),D0
00001818  D168 0002               1268              ADD.W   D0,2(A0)
0000181C                          1269              
0000181C                          1270              ; COMPROBAR BORDES PARA ELIMINAR
0000181C  0C68 FFE2 0002          1271              CMP.W   #-ENEHEIGH,2(A0)        ; UP      
00001822  6D00 0060               1272              BLT     .KILL
00001826  0C68 0280 0002          1273              CMP.W   #SCRHEIGH,2(A0)         ; DOWN
0000182C  6E00 0056               1274              BGT     .KILL 
00001830                          1275              
00001830                          1276              ; VERIFICAR REBOTES
00001830  0C50 024E               1277              CMP.W   #(SCRWIDTH-ENEWIDTH),(A0)    ; RIGHT
00001834  6C00 0010               1278              BGE     .BOUNCE     
00001838  4A50                    1279              TST.W   (A0)                         ; LEFT
0000183A  6F00 000A               1280              BLE     .BOUNCE            
0000183E                          1281              
0000183E  0C50 024E               1282              CMP.W   #SCRWIDTH-ENEWIDTH,(A0)
00001842  6D00 0006               1283              BLT     .COLPLAY
00001846                          1284              
00001846  4468 0004               1285  .BOUNCE     NEG.W   4(A0)
0000184A                          1286  
0000184A  3010                    1287  .COLPLAY    MOVE.W  (A0),D0
0000184C  3228 0002               1288              MOVE.W  2(A0),D1
00001850  383C 001E               1289              MOVE.W  #ENEHEIGH,D4
00001854  3C04                    1290              MOVE.W  D4,D6
00001856  3439 00003F50           1291              MOVE.W  (PLRPOSX),D2
0000185C  3639 00003F52           1292              MOVE.W  (PLRPOSY),D3
00001862  3A3C 001E               1293              MOVE.W  #PLRWIDTH,D5
00001866  3E3C 000F               1294              MOVE.W  #PLRHEIGH,D7
0000186A  4EB8 11EE               1295              JSR     UTLCHCOL
0000186E  4A00                    1296              TST.B   D0
00001870  6700 000E               1297              BEQ     .END
00001874  5339 00003F58           1298              SUBQ.B  #1,(PLRDMG)
0000187A  4EB9 000018EA           1299              JSR     ENEXPLO
00001880                          1300  
00001880  301F                    1301  .END        MOVE.W  (A7)+,D0
00001882  4E75                    1302              RTS
00001884  4EB8 11C0               1303  .KILL       JSR     AGLKILL
00001888  60C0                    1304              BRA     .COLPLAY
0000188A                          1305  
0000188A                          1306  ; -----------------------------------------------------------------------------
0000188A                          1307  ENEPLOT
0000188A                          1308  ; PLOTS AN ASTEROID
0000188A                          1309  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
0000188A                          1310  ; OUTPUT   - NONE
0000188A                          1311  ; MODIFIES - NONE
0000188A                          1312  ; -----------------------------------------------------------------------------
0000188A                          1313              
0000188A  48A7 7800               1314              MOVEM.W D1-D4,-(A7)
0000188E                          1315              
0000188E  223C 00FFFF00           1316              MOVE.L  #ENECOL1,D1
00001894  103C 0050               1317              MOVE.B  #80,D0
00001898  4E4F                    1318              TRAP    #15
0000189A  5200                    1319              ADDQ.B  #1,D0
0000189C  4E4F                    1320              TRAP    #15
0000189E                          1321              
0000189E  3210                    1322              MOVE.W  (A0),D1
000018A0  0641 000C               1323              ADD.W   #ENEWIDTH/4,D1
000018A4  3428 0002               1324              MOVE.W  2(A0),D2
000018A8  3601                    1325              MOVE.W  D1,D3
000018AA  3802                    1326              MOVE.W  D2,D4
000018AC  0643 0019               1327              ADD.W   #ENEWIDTH/2,D3
000018B0  0644 0017               1328              ADD.W   #ENEHEIGH-(ENEHEIGH/4),D4
000018B4  103C 0058               1329              MOVE.B  #88,D0
000018B8  4E4F                    1330              TRAP    #15
000018BA                          1331              
000018BA  223C 0000FF00           1332              MOVE.L  #ENECOL2,D1
000018C0  103C 0050               1333              MOVE.B  #80,D0
000018C4  4E4F                    1334              TRAP    #15
000018C6  5200                    1335              ADDQ.B  #1,D0
000018C8  4E4F                    1336              TRAP    #15
000018CA                          1337              
000018CA  4281                    1338              CLR.L   D1
000018CC  3210                    1339              MOVE.W  (A0),D1
000018CE  3802                    1340              MOVE.W  D2,D4
000018D0  0642 000F               1341              ADD.W   #ENEHEIGH/2,D2
000018D4  3601                    1342              MOVE.W  D1,D3
000018D6  0643 0032               1343              ADD.W   #ENEWIDTH,D3
000018DA  0644 001E               1344              ADD.W   #ENEHEIGH,D4 
000018DE  103C 0058               1345              MOVE.B  #88,D0
000018E2  4E4F                    1346              TRAP    #15
000018E4                          1347              
000018E4                          1348              
000018E4  4C9F 001E               1349              MOVEM.W (A7)+,D1-D4
000018E8  4E75                    1350              RTS
000018EA                          1351  
000018EA                          1352  ; -----------------------------------------------------------------------------
000018EA                          1353  ENEXPLO
000018EA                          1354  ; EXPLODES AN ASTEROID
000018EA                          1355  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
000018EA                          1356  ; OUTPUT   - NONE
000018EA                          1357  ; MODIFIES - NONE
000018EA                          1358  ; -----------------------------------------------------------------------------
000018EA  48E7 F870               1359              MOVEM.L A1-A3/D0-D4,-(A7)
000018EE                          1360              
000018EE                          1361              ; ACTIVAR MUSICA
000018EE  123C 0002               1362              MOVE.B  #AUDMSKNL|AUDIMPID,D1
000018F2  4EB9 00002FDA           1363              JSR     AUDPLAY                 ; PLAY MUSIC
000018F8  13FC 00FF 00003F5A      1364              MOVE.B  #AUDACCY,(AUDACCSN)     ; REJECT SOUND EFFECTS
00001900                          1365              
00001900  383C 000A               1366              MOVE.W  #ASTNFRAG,D4
00001904                          1367              
00001904  43F9 000019BC           1368  .LOOP       LEA     XPLINIT,A1
0000190A  45F9 000019EC           1369              LEA     XPLUPD,A2
00001910  47F9 00001A2A           1370              LEA     XPLPLOT,A3
00001916  303C 0003               1371              MOVE.W  #XPLTYPE,D0
0000191A  3210                    1372              MOVE.W  (A0),D1
0000191C  0641 0019               1373              ADD.W   #ENEWIDTH/2,D1
00001920  3428 0002               1374              MOVE.W  2(A0),D2
00001924  0642 000F               1375              ADD.W   #ENEHEIGH/2,D2
00001928  4EB8 16BC               1376              JSR     AGLADD
0000192C  51CC FFD6               1377              DBRA.W  D4,.LOOP
00001930  4EB8 11C0               1378              JSR     AGLKILL
00001934                          1379              
00001934  4CDF 0E1F               1380              MOVEM.L (A7)+,A1-A3/D0-D4
00001938  4E75                    1381              RTS
0000193A                          1382  
0000193A                          1383  
0000193A                          1384  
0000193A                          1385  -------------------- end include --------------------
0000193A                          1386              INCLUDE "SPAWNER.X68"           ; GESTIÓN DEL SPAWNER
0000193A                          1387  ; =============================================================================
0000193A                          1388  ; GESTIÓN DEL GENERADOR (SPAWNER).
0000193A                          1389  ; =============================================================================
0000193A                          1390  
0000193A                          1391  ; -----------------------------------------------------------------------------
0000193A                          1392  SPWUPD
0000193A                          1393  ; ACTUALIZA EL GENERADOR
0000193A                          1394  ; ENTRADA  - NINGUNA
0000193A                          1395  ; SALIDA   - NINGUNA
0000193A                          1396  ; MODIFICA - NINGUNA
0000193A                          1397  ; -----------------------------------------------------------------------------
0000193A                          1398  
0000193A                          1399  ; ------------------------- GENERACIÓN DE FONDO -------------------------------
0000193A  48E7 8070               1400              MOVEM.L  D0/A1-A3,-(A7)
0000193E                          1401              
0000193E  1039 000032A1           1402              MOVE.B  (SCRCYCCT),D0
00001944  C07C 000F               1403              AND     #$0F,D0                 ; CADA 16 CICLOS
00001948  6600 003E               1404              BNE     .CONTINUE      
0000194C                          1405                
0000194C                          1406              ; CREA UNA NUEVA ESTRELLA GRANDE
0000194C  4201                    1407              CLR.B   D1
0000194E  123C 0001               1408              MOVE.B  #1,D1
00001952  43F9 00001D82           1409              LEA     STRINIT,A1
00001958  45F9 00001DC2           1410              LEA     STRUPD,A2
0000195E  47F9 00001DFA           1411              LEA     STRPLOT,A3
00001964  303C 0004               1412              MOVE.W  #STRTYPE,D0
00001968  4EB8 16BC               1413              JSR     AGLADD
0000196C                          1414              
0000196C                          1415              ; CREA UNA NUEVA ESTRELLA PEQUEÑA
0000196C  4201                    1416              CLR.B   D1
0000196E  43F9 00001D82           1417              LEA     STRINIT,A1
00001974  45F9 00001DC2           1418              LEA     STRUPD,A2
0000197A  47F9 00001DFA           1419              LEA     STRPLOT,A3
00001980  303C 0004               1420              MOVE.W  #STRTYPE,D0
00001984  4EB8 16BC               1421              JSR     AGLADD
00001988                          1422  
00001988                          1423  ; ------------------------- GENERACIÓN DE ENEMIGOS ----------------------------
00001988  1039 00003F5E           1424  .CONTINUE   MOVE.B  (ASTMODE),D0            ; ASTMODE=1 -> GENERA ENEMIGOS
0000198E  4A00                    1425              TST.B   D0
00001990  6700 0024               1426              BEQ     .END
00001994                          1427              
00001994  1039 000032A1           1428              MOVE.B  (SCRCYCCT),D0
0000199A  C07C 000F               1429              AND     #$0F,D0                 ; CADA 16 CICLOS
0000199E  6600 0016               1430              BNE     .END      
000019A2                          1431                
000019A2                          1432              ; CREA UN NUEVO ENEMIGO
000019A2  43F8 17E4               1433              LEA     ENEINIT,A1
000019A6  45F8 180C               1434              LEA     ENEUPD,A2
000019AA  47F8 188A               1435              LEA     ENEPLOT,A3
000019AE  303C 0002               1436              MOVE.W  #ASTTYPE,D0
000019B2  4EB8 16BC               1437              JSR     AGLADD
000019B6                          1438              
000019B6  4CDF 0E01               1439  .END        MOVEM.L (A7)+,D0/A1-A3
000019BA  4E75                    1440              RTS
000019BA  4E75                    1441  -------------------- end include --------------------
000019BC                          1442              INCLUDE "XPLOSION.X68"          ; GESTIÓN DEL AGENTE DE EXPLOSIÓN
000019BC                          1443  ; =============================================================================
000019BC                          1444  ; GESTIÓN DE EXPLOSIONES. ES UN AGENTE.
000019BC                          1445  ; LA MEMORIA LOCAL ES:
000019BC                          1446  ; +0 PALABRA COORDENADA X
000019BC                          1447  ; +2 PALABRA COORDENADA Y
000019BC                          1448  ; +4 PALABRA VELOCIDAD X
000019BC                          1449  ; +6 PALABRA VELOCIDAD Y
000019BC                          1450  ; =============================================================================
000019BC                          1451  
000019BC                          1452  ; -----------------------------------------------------------------------------
000019BC                          1453  XPLINIT
000019BC                          1454  ; INICIALIZA UN ELEMENTO DE EXPLOSIÓN
000019BC                          1455  ; ENTRADA  - A0 PUNTERO A LA MEMORIA LOCAL
000019BC                          1456  ;            D1 COORDENADA X
000019BC                          1457  ;            D2 COORDENADA Y
000019BC                          1458  ; SALIDA   - NINGUNA
000019BC                          1459  ; MODIFICA - NINGUNA
000019BC                          1460  ; NOTA     - ASUME QUE SCRHEIGH ES MAYOR QUE 255
000019BC                          1461  ; -----------------------------------------------------------------------------
000019BC  48E7 E000               1462              MOVEM.L D0-D2,-(A7)
000019C0                          1463              
000019C0  3081                    1464              MOVE.W  D1,(A0)                 ; ESTABLECE LA POSICIÓN X
000019C2  3142 0002               1465              MOVE.W  D2,2(A0)                ; ESTABLECE LA POSICIÓN Y
000019C6                          1466              
000019C6  4EB8 1222               1467              JSR     UTLRAND                 ; ESTABLECE VELOCIDADES ALEATORIAS
000019CA  C07C 001F               1468              AND.W   #$01F,D0
000019CE  0440 000F               1469              SUB.W   #$0F,D0
000019D2  3140 0004               1470              MOVE.W  D0,4(A0)
000019D6                          1471              
000019D6  4EB8 1222               1472              JSR     UTLRAND
000019DA  C07C 001F               1473              AND.W   #$01F,D0
000019DE  0440 000F               1474              SUB.W   #$0F,D0
000019E2  3140 0006               1475              MOVE.W  D0,6(A0)
000019E6  4CDF 0007               1476              MOVEM.L (A7)+,D0-D2
000019EA  4E75                    1477              RTS
000019EC                          1478  
000019EC                          1479  ; -----------------------------------------------------------------------------
000019EC                          1480  XPLUPD
000019EC                          1481  ; ACTUALIZA UN ELEMENTO DE EXPLOSIÓN
000019EC                          1482  ; ENTRADA  - A0 PUNTERO A LA MEMORIA LOCAL
000019EC                          1483  ; SALIDA   - NINGUNA
000019EC                          1484  ; MODIFICA - NINGUNA
000019EC                          1485  ; -----------------------------------------------------------------------------
000019EC  3F00                    1486              MOVE.W  D0,-(A7)
000019EE                          1487              
000019EE  3028 0004               1488              MOVE.W  4(A0),D0                ; ACTUALIZA COORDENADAS
000019F2  9150                    1489              SUB.W   D0,(A0)
000019F4                          1490              
000019F4  3028 0006               1491              MOVE.W  6(A0),D0
000019F8  D168 0002               1492              ADD.W   D0,2(A0)
000019FC                          1493              
000019FC  0C50 FFFE               1494              CMP.W   #-XPLSIZE,(A0)
00001A00  6F00 0022               1495              BLE     .KILL
00001A04  0C50 0280               1496              CMP.W   #SCRWIDTH,(A0)
00001A08  6C00 001A               1497              BGE     .KILL
00001A0C  0C68 FFFE 0002          1498              CMP.W   #-XPLSIZE,2(A0)
00001A12  6F00 0010               1499              BLE     .KILL
00001A16  0C68 0280 0002          1500              CMP.W   #SCRHEIGH,2(A0)
00001A1C  6C00 0006               1501              BGE     .KILL
00001A20                          1502              
00001A20                          1503              
00001A20                          1504              
00001A20  301F                    1505  .END        MOVE.W  (A7)+,D0
00001A22  4E75                    1506              RTS
00001A24  4EB8 11C0               1507  .KILL       JSR   AGLKILL
00001A28  60F6                    1508              BRA   .END
00001A2A                          1509  
00001A2A                          1510  ; -----------------------------------------------------------------------------
00001A2A                          1511  XPLPLOT
00001A2A                          1512  ; TRAZA UN ELEMENTO DE EXPLOSIÓN
00001A2A                          1513  ; ENTRADA  - A0 PUNTERO A LA MEMORIA LOCAL
00001A2A                          1514  ; SALIDA   - NINGUNA
00001A2A                          1515  ; MODIFICA - NINGUNA
00001A2A                          1516  ; -----------------------------------------------------------------------------
00001A2A                          1517m             UTLSPEN #XPLPENCL
00001A2A                          1518m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL LÁPIZ.
00001A2A                          1519m ; ENTRADA  - #XPLPENCL COLOR EN FORMATO $00BBGGRR
00001A2A                          1520m ; SALIDA   - NINGUNA
00001A2A                          1521m ; MODIFICA - D0,D1
00001A2A                          1522m ; -----------------------------------------------------------------------------
00001A36                          1523m             UTLSFIL #XPLFILCL
00001A36                          1524m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
00001A36                          1525m ; ENTRADA  - #XPLFILCL COLOR EN FORMATO $00BBGGRR
00001A36                          1526m ; SALIDA   - NINGUNA
00001A36                          1527m ; MODIFICA - D0,D1
00001A36                          1528m ; -----------------------------------------------------------------------------
00001A42  48A7 7800               1529              MOVEM.W D1-D4,-(A7)
00001A46  3210                    1530              MOVE.W  (A0),D1
00001A48  3428 0002               1531              MOVE.W  2(A0),D2
00001A4C  3601                    1532              MOVE.W  D1,D3
00001A4E  3802                    1533              MOVE.W  D2,D4
00001A50  5443                    1534              ADD.W   #XPLSIZE,D3
00001A52  5444                    1535              ADD.W   #XPLSIZE,D4
00001A54  103C 0058               1536              MOVE.B  #88,D0
00001A58  4E4F                    1537              TRAP    #15
00001A5A  4C9F 001E               1538              MOVEM.W (A7)+,D1-D4
00001A5E  4E75                    1539              RTS
00001A5E  4E75                    1540  -------------------- end include --------------------
00001A60                          1541              INCLUDE "STATES.X68"            ; GESTIÓN DE ESTADOS DEL JUEGO
00001A60                          1542  ; =============================================================================
00001A60                          1543  ; GESTIÓN DE ESTADOS DEL JUEGO
00001A60                          1544  ; =============================================================================
00001A60                          1545  
00001A60                          1546  ; -----------------------------------------------------------------------------
00001A60                          1547  STAINIT
00001A60                          1548  ; INICIALIZA EL GESTOR DE ESTADOS
00001A60                          1549  ; ENTRADA  - NINGUNA
00001A60                          1550  ; SALIDA   - NINGUNA
00001A60                          1551  ; MODIFICA - NINGUNA
00001A60                          1552  ; -----------------------------------------------------------------------------
00001A60  33FC FFFF 00003F40      1553              MOVE.W  #STANONE,(STACUR)
00001A68  33FC 0000 00003F42      1554              MOVE.W  #STAINTR,(STANEXT)
00001A70  4239 00003F5A           1555              CLR.B   (AUDACCSN)
00001A76                          1556  
00001A76  4E75                    1557              RTS
00001A78                          1558  
00001A78                          1559  ; -----------------------------------------------------------------------------
00001A78                          1560  STAUPD
00001A78                          1561  ; REALIZA LA ACTUALIZACIÓN DEL ESTADO Y LA INICIALIZACIÓN SI ES NECESARIO
00001A78                          1562  ; ENTRADA  - NINGUNA
00001A78                          1563  ; SALIDA   - NINGUNA
00001A78                          1564  ; MODIFICA - NINGUNA
00001A78                          1565  ; -----------------------------------------------------------------------------
00001A78  48E7 8080               1566              MOVEM.L D0/A0,-(A7)
00001A7C  4280                    1567              CLR.L   D0
00001A7E  3039 00003F42           1568              MOVE.W  (STANEXT),D0
00001A84  B079 00003F40           1569              CMP.W   (STACUR),D0
00001A8A  6700 0012               1570              BEQ     .DOUPD
00001A8E  33C0 00003F40           1571              MOVE.W  D0,(STACUR)             ; SI EL ESTADO CAMBIÓ, HACE INIT
00001A94  E588                    1572              LSL.L   #2,D0
00001A96  2040                    1573              MOVE.L  D0,A0
00001A98  2068 1AB6               1574              MOVE.L  .INITBL(A0),A0
00001A9C  4E90                    1575              JSR     (A0)
00001A9E  4280                    1576  .DOUPD      CLR.L   D0                      ; EN CUALQUIER CASO, ACTUALIZAR
00001AA0  3039 00003F40           1577              MOVE.W  (STACUR),D0
00001AA6  E588                    1578              LSL.L   #2,D0
00001AA8  2040                    1579              MOVE.L  D0,A0
00001AAA  2068 1AC2               1580              MOVE.L  .UPDTBL(A0),A0
00001AAE  4E90                    1581              JSR     (A0)
00001AB0  4CDF 0101               1582              MOVEM.L (A7)+,D0/A0
00001AB4  4E75                    1583              RTS
00001AB6= 00001114 00001340 ...   1584  .INITBL     DC.L    STAINTRI,STAPLAYI,STAEMPTY
00001AC2= 00001B0C 00001AF8 ...   1585  .UPDTBL     DC.L    STAINTRU,STAPLAYU,STAGOVRU
00001ACE                          1586  
00001ACE                          1587  ; -----------------------------------------------------------------------------
00001ACE                          1588  STAPLOT
00001ACE                          1589  ; REALIZA LA REPRESENTACIÓN DEL ESTADO
00001ACE                          1590  ; ENTRADA  - NINGUNA
00001ACE                          1591  ; SALIDA   - NINGUNA
00001ACE                          1592  ; MODIFICA - NINGUNA
00001ACE                          1593  ; -----------------------------------------------------------------------------
00001ACE  48E7 8080               1594              MOVEM.L D0/A0,-(A7)
00001AD2  4280                    1595              CLR.L   D0
00001AD4  3039 00003F40           1596              MOVE.W  (STACUR),D0
00001ADA  E588                    1597              LSL.L   #2,D0
00001ADC  2040                    1598              MOVE.L  D0,A0
00001ADE  2068 1AEA               1599              MOVE.L  .PLTTBL(A0),A0
00001AE2  4E90                    1600              JSR     (A0)
00001AE4  4CDF 0101               1601              MOVEM.L (A7)+,D0/A0
00001AE8  4E75                    1602              RTS
00001AEA= 00001B22 00001B04 ...   1603  .PLTTBL     DC.L    STAINTRP,STAPLAYP,STAGOVRP
00001AF6                          1604  
00001AF6                          1605  ; -----------------------------------------------------------------------------
00001AF6                          1606  STAEMPTY
00001AF6                          1607  ; SUBRUTINA VACÍA PARA CASOS EN LOS QUE NO HAY NADA QUE HACER
00001AF6                          1608  ; ENTRADA  - NINGUNA
00001AF6                          1609  ; SALIDA   - NINGUNA
00001AF6                          1610  ; MODIFICA - NINGUNA
00001AF6                          1611  ; NOTA     - SOLO UN MARCADOR DE POSICIÓN. NADA QUE HACER.
00001AF6                          1612  ; -----------------------------------------------------------------------------
00001AF6  4E75                    1613              RTS
00001AF8                          1614  
00001AF8                          1615  ; -----------------------------------------------------------------------------
00001AF8  =00001340               1616  STAPLAYI    EQU     PLRINIT
00001AF8                          1617  ; INICIALIZACIÓN DEL ESTADO DE JUEGO.
00001AF8                          1618  ; ENTRADA  - NINGUNA
00001AF8                          1619  ; SALIDA   - NINGUNA
00001AF8                          1620  ; MODIFICA - NINGUNA
00001AF8                          1621  ; NOTA     - SOLO UN ENVOLTORIO PARA PLRINIT
00001AF8                          1622  ; -----------------------------------------------------------------------------
00001AF8                          1623  
00001AF8                          1624  ; -----------------------------------------------------------------------------
00001AF8                          1625  STAPLAYU
00001AF8                          1626  ; ACTUALIZACIÓN DEL ESTADO DE JUEGO
00001AF8                          1627  ; ENTRADA  - NINGUNA
00001AF8                          1628  ; SALIDA   - NINGUNA
00001AF8                          1629  ; MODIFICA - NINGUNA
00001AF8                          1630  ; -----------------------------------------------------------------------------           
00001AF8  4EB8 138C               1631              JSR     PLRUPD
00001AFC  4EB8 193A               1632              JSR     SPWUPD
00001B00  6000 FBD4               1633              BRA     AGLUPD
00001B04                          1634  
00001B04                          1635  ; -----------------------------------------------------------------------------
00001B04                          1636  STAPLAYP
00001B04                          1637  ; REPRESENTACIÓN DEL ESTADO DE JUEGO
00001B04                          1638  ; ENTRADA  - NINGUNA
00001B04                          1639  ; SALIDA   - NINGUNA
00001B04                          1640  ; MODIFICA - NINGUNA
00001B04                          1641  ; -----------------------------------------------------------------------------
00001B04  4EB8 16FA               1642              JSR     AGLPLOT
00001B08  6000 F9A8               1643              BRA     PLRPLOT
00001B0C                          1644  
00001B0C                          1645  ; -----------------------------------------------------------------------------
00001B0C  =00001114               1646  STAINTRI    EQU     DMMINIT
00001B0C                          1647  ; INICIALIZACIÓN DEL ESTADO DE INTRODUCCIÓN
00001B0C                          1648  ; ENTRADA  - NINGUNA
00001B0C                          1649  ; SALIDA   - NINGUNA
00001B0C                          1650  ; MODIFICA - NINGUNA
00001B0C                          1651  ; NOTA     - SOLO UN ENVOLTORIO PARA DMMINIT PARA LIBERAR TODA LA MEMORIA
00001B0C                          1652  ; -----------------------------------------------------------------------------
00001B0C                          1653  
00001B0C                          1654  ; -----------------------------------------------------------------------------
00001B0C                          1655  STAINTRU
00001B0C                          1656  ; ACTUALIZACIÓN DEL ESTADO DE INTRODUCCIÓN
00001B0C                          1657  ; ENTRADA  - NINGUNA
00001B0C                          1658  ; SALIDA   - NINGUNA
00001B0C                          1659  ; MODIFICA - NINGUNA
00001B0C                          1660  ; -----------------------------------------------------------------------------
00001B0C  0839 0004 0000329F      1661              BTST.B  #KBDBITF1,(KBDEDGE)
00001B14  6700 000A               1662              BEQ     .END
00001B18  33FC 0001 00003F42      1663              MOVE.W  #STAPLAY,(STANEXT)
00001B20  4E75                    1664  .END        RTS
00001B22                          1665  
00001B22                          1666  ; -----------------------------------------------------------------------------
00001B22                          1667  STAINTRP
00001B22                          1668  ; REPRESENTACIÓN DEL ESTADO DE INTRODUCCIÓN
00001B22                          1669  ; ENTRADA  - NINGUNA
00001B22                          1670  ; SALIDA   - NINGUNA
00001B22                          1671  ; MODIFICA - NINGUNA
00001B22                          1672  ; -----------------------------------------------------------------------------
00001B22  48E7 C040               1673              MOVEM.L A1/D0-D1,-(A7)
00001B26                          1674                                      
00001B26                          1675              ; ACTIVAR MUSICA
00001B26  123C 0080               1676              MOVE.B  #AUDMSKLP|AUDINTID,D1
00001B2A  4EB9 00002FDA           1677              JSR     AUDPLAY                 ; REPRODUCIR MÚSICA
00001B30  13FC 0000 00003F5A      1678              MOVE.B  #AUDACCN,(AUDACCSN)     ; RECHAZAR EFECTOS DE SONIDO
00001B38                          1679                          
00001B38  41F9 00001F06           1680              LEA     INTRO,A0
00001B3E  4280                    1681              CLR.L   D0                      ; COLOR
00001B40  4285                    1682              CLR.L   D5                      ; COLUMNAS
00001B42  4286                    1683              CLR.L   D6                      ; FILAS
00001B44                          1684              
00001B44  323C 00C0               1685              MOVE.W  #(SCRWIDTH/2)-(IMGINTSZ*IMGTILSZ/2),D1
00001B48  343C 0032               1686              MOVE.W  #50,D2
00001B4C  3601                    1687              MOVE.W  D1,D3
00001B4E  5043                    1688              ADDQ.W  #IMGTILSZ,D3
00001B50  3802                    1689              MOVE.W  D2,D4
00001B52  5044                    1690              ADDQ.W  #IMGTILSZ,D4 
00001B54                          1691              
00001B54                          1692              
00001B54                          1693              ; PINTAMOS IMAGEN 
00001B54  2018                    1694  .LOOP       MOVE.L  (A0)+,D0                ; GUARDAMOS DATO
00001B56                          1695              
00001B56  BA7C 001F               1696              CMP.W   #IMGINTSZ-1, D5         ; HEMOS LLEGADO AL LATERAL
00001B5A  6700 0024               1697              BEQ     .ALTURA
00001B5E                          1698              
00001B5E  4287                    1699              CLR.L   D7
00001B60  3E01                    1700              MOVE.W  D1,D7                   ; GUARDAMOS EN REGISTRO AUXILIAR
00001B62                          1701              
00001B62  2200                    1702              MOVE.L  D0,D1                   ; ESCOGEMOS COLOR
00001B64  303C 0050               1703              MOVE.W  #80,D0
00001B68  4E4F                    1704              TRAP    #15
00001B6A  5200                    1705              ADDQ.B  #1,D0
00001B6C  4E4F                    1706              TRAP    #15
00001B6E                          1707              
00001B6E  4281                    1708              CLR.L   D1
00001B70  3207                    1709              MOVE.W  D7,D1                   ; DEVOLVEMOS AUXILIAR
00001B72  303C 0057               1710              MOVE.W  #87,D0                  ; PINTAMOS
00001B76  4E4F                    1711              TRAP    #15                 
00001B78                          1712                         
00001B78  5245                    1713  .MOVE       ADDQ.W  #1,D5                   ; SUMAMOS COLUMNA
00001B7A  5041                    1714              ADD.W   #IMGTILSZ,D1
00001B7C  5043                    1715              ADD.W   #IMGTILSZ,D3
00001B7E  60D4                    1716              BRA     .LOOP
00001B80                          1717              
00001B80                          1718  
00001B80  BC7C 001F               1719  .ALTURA     CMP.W   #IMGINTSZ-1,D6          ; HEMOS ACABADO
00001B84  6700 0016               1720              BEQ     .END
00001B88                          1721              
00001B88  5246                    1722              ADDQ.W  #1,D6                   ; SUMAMOS FILA
00001B8A  5042                    1723              ADD.W   #IMGTILSZ,D2
00001B8C  5044                    1724              ADD.W   #IMGTILSZ,D4
00001B8E                          1725              
00001B8E                          1726              
00001B8E  4285                    1727              CLR.L   D5
00001B90  323C 00C0               1728              MOVE.W  #(SCRWIDTH/2)-(IMGINTSZ*IMGTILSZ/2),D1 ;INICIALIZAMOS FILA
00001B94  3601                    1729              MOVE.W  D1,D3
00001B96  0643 0009               1730              ADD.W   #IMGTILSZ+1,D3
00001B9A  60B8                    1731              BRA     .LOOP
00001B9C                          1732  
00001B9C                          1733              
00001B9C                          1734              ; MOSTRAR MARCADOR
00001B9C                          1735m .END        UTLLOCT TOPTXTX,TOPTXTY
00001B9C                          1736m ; ENVOLTORIO PARA LA POSICIONAMIENTO DE TEXTO DESDE TRAP 15
00001B9C                          1737m ; ENTRADA  - TOPTXTX X, TOPTXTY Y
00001B9C                          1738m ; SALIDA   - NINGUNA
00001B9C                          1739m ; MODIFICA - D0,D1
00001B9C                          1740m ; -----------------------------------------------------------------------------
00001BA6                          1741m             UTLSFIL #$00000000
00001BA6                          1742m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
00001BA6                          1743m ; ENTRADA  - #$00000000 COLOR EN FORMATO $00BBGGRR
00001BA6                          1744m ; SALIDA   - NINGUNA
00001BA6                          1745m ; MODIFICA - D0,D1
00001BA6                          1746m ; -----------------------------------------------------------------------------
00001BAE  43F9 00001C55           1747              LEA     .TOPS,A1
00001BB4  103C 000E               1748              MOVE.B  #14,D0
00001BB8  4E4F                    1749              TRAP    #15
00001BBA                          1750              
00001BBA  4EB9 000031DC           1751              JSR     SCOREAD
00001BC0  41F9 00003F60           1752              LEA     FILEBUFF,A0
00001BC6  4281                    1753              CLR.L   D1
00001BC8                          1754              
00001BC8                          1755m             UTLLOCT TP1TXTX,TP1TXTY
00001BC8                          1756m ; ENVOLTORIO PARA LA POSICIONAMIENTO DE TEXTO DESDE TRAP 15
00001BC8                          1757m ; ENTRADA  - TP1TXTX X, TP1TXTY Y
00001BC8                          1758m ; SALIDA   - NINGUNA
00001BC8                          1759m ; MODIFICA - D0,D1
00001BC8                          1760m ; -----------------------------------------------------------------------------
00001BD2  43F9 00001C6A           1761              LEA     .TOP1,A1
00001BD8  3218                    1762              MOVE.W  (A0)+,D1
00001BDA  103C 0011               1763              MOVE.B  #17,D0
00001BDE  4E4F                    1764              TRAP    #15
00001BE0                          1765              
00001BE0                          1766m             UTLLOCT TP2TXTX,TP2TXTY
00001BE0                          1767m ; ENVOLTORIO PARA LA POSICIONAMIENTO DE TEXTO DESDE TRAP 15
00001BE0                          1768m ; ENTRADA  - TP2TXTX X, TP2TXTY Y
00001BE0                          1769m ; SALIDA   - NINGUNA
00001BE0                          1770m ; MODIFICA - D0,D1
00001BE0                          1771m ; -----------------------------------------------------------------------------
00001BEA  43F9 00001C6E           1772              LEA     .TOP2,A1
00001BF0  3218                    1773              MOVE.W  (A0)+,D1
00001BF2  103C 0011               1774              MOVE.B  #17,D0
00001BF6  4E4F                    1775              TRAP    #15
00001BF8                          1776              
00001BF8                          1777m             UTLLOCT TP3TXTX,TP3TXTY
00001BF8                          1778m ; ENVOLTORIO PARA LA POSICIONAMIENTO DE TEXTO DESDE TRAP 15
00001BF8                          1779m ; ENTRADA  - TP3TXTX X, TP3TXTY Y
00001BF8                          1780m ; SALIDA   - NINGUNA
00001BF8                          1781m ; MODIFICA - D0,D1
00001BF8                          1782m ; -----------------------------------------------------------------------------
00001C02  43F9 00001C72           1783              LEA     .TOP3,A1
00001C08  3218                    1784              MOVE.W  (A0)+,D1
00001C0A  103C 0011               1785              MOVE.B  #17,D0
00001C0E  4E4F                    1786              TRAP    #15
00001C10                          1787              
00001C10                          1788              ; MOSTRAR EL MENSAJE
00001C10                          1789m             UTLLOCT INTPRSX,INTPRSY
00001C10                          1790m ; ENVOLTORIO PARA LA POSICIONAMIENTO DE TEXTO DESDE TRAP 15
00001C10                          1791m ; ENTRADA  - INTPRSX X, INTPRSY Y
00001C10                          1792m ; SALIDA   - NINGUNA
00001C10                          1793m ; MODIFICA - D0,D1
00001C10                          1794m ; -----------------------------------------------------------------------------
00001C1A                          1795m             UTLSPEN #INTPRSC
00001C1A                          1796m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL LÁPIZ.
00001C1A                          1797m ; ENTRADA  - #INTPRSC COLOR EN FORMATO $00BBGGRR
00001C1A                          1798m ; SALIDA   - NINGUNA
00001C1A                          1799m ; MODIFICA - D0,D1
00001C1A                          1800m ; -----------------------------------------------------------------------------
00001C26                          1801m             UTLSFIL #$00000000
00001C26                          1802m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
00001C26                          1803m ; ENTRADA  - #$00000000 COLOR EN FORMATO $00BBGGRR
00001C26                          1804m ; SALIDA   - NINGUNA
00001C26                          1805m ; MODIFICA - D0,D1
00001C26                          1806m ; -----------------------------------------------------------------------------
00001C2E  43F9 00001C76           1807              LEA     .PRSSTR,A1
00001C34  103C 000E               1808              MOVE.B  #14,D0
00001C38  4E4F                    1809              TRAP    #15    
00001C3A                          1810              
00001C3A  4CDF 0203               1811              MOVEM.L (A7)+,A1/D0-D1
00001C3E  4E75                    1812              RTS
00001C40                          1813  
00001C40= 53 50 41 43 45 20 ...   1814  .TITSTR     DC.B    'SPACE INVADERS 68000',0
00001C55= 4D 45 4A 4F 52 45 ...   1815  .TOPS       DC.B    'MEJORES PUNTUACIONES',0
00001C6A= 31 2E 20 00             1816  .TOP1       DC.B    '1. ',0
00001C6E= 32 2E 20 00             1817  .TOP2       DC.B    '2. ',0
00001C72= 33 2E 20 00             1818  .TOP3       DC.B    '3. ',0
00001C76= 50 55 4C 53 41 20 ...   1819  .PRSSTR     DC.B    'PULSA ESPACIO PARA JUGAR',0
00001C90                          1820              DS.W    0
00001C90                          1821  
00001C90                          1822  ; -----------------------------------------------------------------------------
00001C90                          1823  STAGOVRU
00001C90                          1824  ; ACTUALIZACIÓN DEL ESTADO DE FIN DEL JUEGO
00001C90                          1825  ; ENTRADA  - NINGUNA
00001C90                          1826  ; SALIDA   - NINGUNA
00001C90                          1827  ; MODIFICA - NINGUNA
00001C90                          1828  ; -----------------------------------------------------------------------------
00001C90  0839 0004 0000329F      1829              BTST.B  #KBDBITF1,(KBDEDGE)
00001C98  6700 0010               1830              BEQ     .END
00001C9C                          1831              
00001C9C                          1832              ; GUARDAMOS PUNTUACIÓN
00001C9C  4EB9 0000316A           1833              JSR     SCOUPD
00001CA2                          1834              
00001CA2  33FC 0000 00003F42      1835              MOVE.W  #STAINTR,(STANEXT)
00001CAA  4E75                    1836  .END        RTS
00001CAC                          1837  
00001CAC                          1838  ; -----------------------------------------------------------------------------
00001CAC                          1839  STAGOVRP
00001CAC                          1840  ; REPRESENTACIÓN DEL ESTADO DE FIN DEL JUEGO
00001CAC                          1841  ; ENTRADA  - NINGUNA
00001CAC                          1842  ; SALIDA   - NINGUNA
00001CAC                          1843  ; MODIFICA - NINGUNA
00001CAC                          1844  ; -----------------------------------------------------------------------------
00001CAC  48E7 C0C0               1845              MOVEM.L A0-A1/D0-D1,-(A7)
00001CB0                          1846                                     
00001CB0                          1847m             UTLLOCT GOVSTRX,GOVSTRY
00001CB0                          1848m ; ENVOLTORIO PARA LA POSICIONAMIENTO DE TEXTO DESDE TRAP 15
00001CB0                          1849m ; ENTRADA  - GOVSTRX X, GOVSTRY Y
00001CB0                          1850m ; SALIDA   - NINGUNA
00001CB0                          1851m ; MODIFICA - D0,D1
00001CB0                          1852m ; -----------------------------------------------------------------------------
00001CBA                          1853m             UTLSPEN #GOVSTRC
00001CBA                          1854m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL LÁPIZ.
00001CBA                          1855m ; ENTRADA  - #GOVSTRC COLOR EN FORMATO $00BBGGRR
00001CBA                          1856m ; SALIDA   - NINGUNA
00001CBA                          1857m ; MODIFICA - D0,D1
00001CBA                          1858m ; -----------------------------------------------------------------------------
00001CC6                          1859m             UTLSFIL #$00000000
00001CC6                          1860m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
00001CC6                          1861m ; ENTRADA  - #$00000000 COLOR EN FORMATO $00BBGGRR
00001CC6                          1862m ; SALIDA   - NINGUNA
00001CC6                          1863m ; MODIFICA - D0,D1
00001CC6                          1864m ; -----------------------------------------------------------------------------
00001CCE  43F9 00001D54           1865              LEA     .GOVSTR,A1
00001CD4  103C 000E               1866              MOVE.B  #14,D0
00001CD8  4E4F                    1867              TRAP    #15
00001CDA                          1868              
00001CDA                          1869m             UTLLOCT GOVSCOX,GOVSCOY
00001CDA                          1870m ; ENVOLTORIO PARA LA POSICIONAMIENTO DE TEXTO DESDE TRAP 15
00001CDA                          1871m ; ENTRADA  - GOVSCOX X, GOVSCOY Y
00001CDA                          1872m ; SALIDA   - NINGUNA
00001CDA                          1873m ; MODIFICA - D0,D1
00001CDA                          1874m ; -----------------------------------------------------------------------------
00001CE4                          1875m             UTLSPEN #GOVSTRC
00001CE4                          1876m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL LÁPIZ.
00001CE4                          1877m ; ENTRADA  - #GOVSTRC COLOR EN FORMATO $00BBGGRR
00001CE4                          1878m ; SALIDA   - NINGUNA
00001CE4                          1879m ; MODIFICA - D0,D1
00001CE4                          1880m ; -----------------------------------------------------------------------------
00001CF0                          1881m             UTLSFIL #$00000000
00001CF0                          1882m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
00001CF0                          1883m ; ENTRADA  - #$00000000 COLOR EN FORMATO $00BBGGRR
00001CF0                          1884m ; SALIDA   - NINGUNA
00001CF0                          1885m ; MODIFICA - D0,D1
00001CF0                          1886m ; -----------------------------------------------------------------------------
00001CF8  43F9 00001D74           1887              LEA     .GOVSCO,A1
00001CFE  4281                    1888              CLR.L   D1
00001D00  3239 00003F56           1889              MOVE.W  (PLRSCORE),D1
00001D06  103C 0011               1890              MOVE.B  #17,D0
00001D0A  4E4F                    1891              TRAP    #15
00001D0C                          1892              
00001D0C                          1893              ; MIRAMOS SI ES NUEVO RÉCORD
00001D0C  4EB9 000031DC           1894              JSR     SCOREAD
00001D12  41F9 00003F60           1895              LEA     FILEBUFF,A0
00001D18  3210                    1896              MOVE.W  (A0),D1
00001D1A  B279 00003F56           1897              CMP.W   (PLRSCORE),D1
00001D20  6C00 002C               1898              BGE     .NOESREC
00001D24                          1899              
00001D24                          1900m             UTLLOCT GOVNRX,GOVNRY
00001D24                          1901m ; ENVOLTORIO PARA LA POSICIONAMIENTO DE TEXTO DESDE TRAP 15
00001D24                          1902m ; ENTRADA  - GOVNRX X, GOVNRY Y
00001D24                          1903m ; SALIDA   - NINGUNA
00001D24                          1904m ; MODIFICA - D0,D1
00001D24                          1905m ; -----------------------------------------------------------------------------
00001D2E                          1906m             UTLSPEN #GOVSTRC
00001D2E                          1907m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL LÁPIZ.
00001D2E                          1908m ; ENTRADA  - #GOVSTRC COLOR EN FORMATO $00BBGGRR
00001D2E                          1909m ; SALIDA   - NINGUNA
00001D2E                          1910m ; MODIFICA - D0,D1
00001D2E                          1911m ; -----------------------------------------------------------------------------
00001D3A                          1912m             UTLSFIL #$00000000
00001D3A                          1913m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
00001D3A                          1914m ; ENTRADA  - #$00000000 COLOR EN FORMATO $00BBGGRR
00001D3A                          1915m ; SALIDA   - NINGUNA
00001D3A                          1916m ; MODIFICA - D0,D1
00001D3A                          1917m ; -----------------------------------------------------------------------------
00001D42  43F9 00001D5F           1918              LEA     .GOVNRD,A1
00001D48  103C 000E               1919              MOVE.B  #14,D0
00001D4C  4E4F                    1920              TRAP    #15
00001D4E                          1921              
00001D4E                          1922                         
00001D4E  4CDF 0303               1923  .NOESREC    MOVEM.L (A7)+,A0-A1/D0-D1
00001D52  4E75                    1924              RTS
00001D54                          1925  
00001D54= 47 41 4D 45 20 20 ...   1926  .GOVSTR     DC.B    'GAME  OVER',0
00001D5F= A1 A1 A1 20 4E 55 ...   1927  .GOVNRD     DC.B    '¡¡¡ NUEVO RÉCORD !!!',0
00001D74= 50 55 4E 54 55 41 ...   1928  .GOVSCO     DC.B    'PUNTUACIÓN: ',0
00001D82                          1929              DS.W    0
00001D82                          1930  
00001D82                          1931  -------------------- end include --------------------
00001D82                          1932              INCLUDE "STAR.X68"              ; GESTIÓN DEL AGENTE ESTRELLA
00001D82                          1933  ; =============================================================================
00001D82                          1934  ; GESTIÓN DE ESTRELLAS. ES UN AGENTE.
00001D82                          1935  ; LA MEMORIA LOCAL ES:
00001D82                          1936  ; +0 PALABRA COORDENADA X
00001D82                          1937  ; +2 PALABRA COORDENADA Y
00001D82                          1938  ; +4 PALABRA VELOCIDAD Y
00001D82                          1939  ; +6 PALABRA TAMAÑO
00001D82                          1940  ; =============================================================================
00001D82                          1941  
00001D82                          1942  ; -----------------------------------------------------------------------------
00001D82                          1943  STRINIT
00001D82                          1944  ; INICIALIZA LA ESTRELLA GRANDE
00001D82                          1945  ; ENTRADA  - A0 PUNTERO A LA MEMORIA LOCAL
00001D82                          1946  ;            D1: 0 -> PEQUEÑA, 1 -> GRANDE
00001D82                          1947  ; SALIDA   - NINGUNA
00001D82                          1948  ; MODIFICA - NINGUNA
00001D82                          1949  ; -----------------------------------------------------------------------------
00001D82                          1950              
00001D82  48A7 C000               1951              MOVEM.W D0-D1,-(A7)
00001D86                          1952              
00001D86  B23C 0001               1953              CMP.B   #1, D1
00001D8A  6700 0012               1954              BEQ     .BIG
00001D8E  317C 0002 0004          1955              MOVE.W  #SSTRSPEED,4(A0)        ; VELOCIDAD Y
00001D94  317C 0002 0006          1956              MOVE.W  #SSTRSIZE,6(A0)         ; TAMAÑO
00001D9A  6000 000E               1957              BRA     .END
00001D9E                          1958              
00001D9E  317C 0005 0004          1959  .BIG        MOVE.W  #BSTRSPEED,4(A0)        ; VELOCIDAD Y
00001DA4  317C 0005 0006          1960              MOVE.W  #BSTRSIZE,6(A0)         ; TAMAÑO
00001DAA                          1961              
00001DAA  4EB8 1222               1962  .END        JSR     UTLRAND
00001DAE  3200                    1963              MOVE.W  D0, D1
00001DB0  4EB8 1222               1964              JSR     UTLRAND
00001DB4  D041                    1965              ADD.W   D1, D0
00001DB6                          1966              
00001DB6  3080                    1967              MOVE.W  D0,(A0)                 ; POSICIÓN X (PSEUDO-ALEATORIA)
00001DB8  4268 0002               1968              CLR.W   2(A0)                   ; POSICIÓN Y 
00001DBC                          1969                         
00001DBC  4C9F 0003               1970              MOVEM.W (A7)+,D0-D1
00001DC0  4E75                    1971              RTS
00001DC2                          1972              
00001DC2                          1973  ; -----------------------------------------------------------------------------
00001DC2                          1974  STRUPD
00001DC2                          1975  ; ACTUALIZA UNA ESTRELLA
00001DC2                          1976  ; ENTRADA  - A0 PUNTERO A LA MEMORIA LOCAL
00001DC2                          1977  ; SALIDA   - NINGUNA
00001DC2                          1978  ; MODIFICA - NINGUNA
00001DC2                          1979  ; -----------------------------------------------------------------------------
00001DC2  3F00                    1980              MOVE.W  D0,-(A7)
00001DC4                          1981              
00001DC4  3028 0004               1982              MOVE.W  4(A0),D0                ; ACTUALIZAR COORDENADAS
00001DC8  D168 0002               1983              ADD.W   D0,2(A0)
00001DCC                          1984              
00001DCC                          1985              ; VERIFICAR BORDES PARA ELIMINAR
00001DCC  0C68 0280 0002          1986              CMP.W   #SCRHEIGH,2(A0)         ; ABAJO  
00001DD2  6D00 0022               1987              BLT     .END
00001DD6  4EB8 11C0               1988              JSR     AGLKILL                 ; ELIMINAR
00001DDA                          1989  
00001DDA  0C68 0005 0006          1990              CMP     #BSTRSIZE,6(A0)         ; ES ESTRELLA GRANDE
00001DE0  6700 0014               1991              BEQ     .END
00001DE4                          1992              
00001DE4  1039 00003F5E           1993              MOVE.B  (ASTMODE),D0            ; ACTIVAR MODO NORMAL
00001DEA  4A00                    1994              TST.B   D0                      ; SI ASTMODE=0
00001DEC  6600 0008               1995              BNE     .END
00001DF0  5239 00003F5E           1996              ADDQ.B  #1,(ASTMODE)
00001DF6                          1997              
00001DF6                          1998              
00001DF6  301F                    1999  .END        MOVE.W  (A7)+,D0
00001DF8  4E75                    2000              RTS      
00001DFA                          2001  
00001DFA                          2002  ; -----------------------------------------------------------------------------
00001DFA                          2003  STRPLOT
00001DFA                          2004  ; DIBUJA UNA ESTRELLA
00001DFA                          2005  ; ENTRADA  - A0 PUNTERO A LA MEMORIA LOCAL
00001DFA                          2006  ; SALIDA   - NINGUNA
00001DFA                          2007  ; MODIFICA - NINGUNA
00001DFA                          2008  ; -----------------------------------------------------------------------------
00001DFA                          2009m             UTLSPEN #$0000FFFF
00001DFA                          2010m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL LÁPIZ.
00001DFA                          2011m ; ENTRADA  - #$0000FFFF COLOR EN FORMATO $00BBGGRR
00001DFA                          2012m ; SALIDA   - NINGUNA
00001DFA                          2013m ; MODIFICA - D0,D1
00001DFA                          2014m ; -----------------------------------------------------------------------------
00001E06                          2015m             UTLSFIL #$0000FFFF
00001E06                          2016m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
00001E06                          2017m ; ENTRADA  - #$0000FFFF COLOR EN FORMATO $00BBGGRR
00001E06                          2018m ; SALIDA   - NINGUNA
00001E06                          2019m ; MODIFICA - D0,D1
00001E06                          2020m ; -----------------------------------------------------------------------------
00001E12  48A7 7800               2021              MOVEM.W D1-D4,-(A7)
00001E16                          2022              
00001E16  3210                    2023              MOVE.W  (A0),D1
00001E18  3428 0002               2024              MOVE.W  2(A0),D2
00001E1C  3601                    2025              MOVE.W  D1,D3
00001E1E  3802                    2026              MOVE.W  D2,D4
00001E20  D668 0006               2027              ADD.W   6(A0),D3
00001E24  D868 0006               2028              ADD.W   6(A0),D4
00001E28  103C 0058               2029              MOVE.B  #88,D0
00001E2C  4E4F                    2030              TRAP    #15
00001E2E                          2031              
00001E2E  4C9F 001E               2032              MOVEM.W (A7)+,D1-D4
00001E32  4E75                    2033              RTS
00001E32  4E75                    2034  -------------------- end include --------------------
00001E34                          2035              INCLUDE "IMAGES/SPRITES.X68"    ; BITMAP DE SPRITES
00001E34                          2036  
00001E34= 00 00 00 00 00 00 ...   2037  HEART       DC.B    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
00001E43= 00 00 00 00 00 00 ...   2038              DC.B    0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0
00001E52= 00 00 00 00 00 00 ...   2039              DC.B    0, 0, 0, 0, 0, 0, 2, 1, 2, 0, 0, 0, 0, 0, 0
00001E61= 00 00 00 00 00 02 ...   2040              DC.B    0, 0, 0, 0, 0, 2, 1, 1, 1, 2, 0, 0, 0, 0, 0
00001E70= 00 00 00 00 02 01 ...   2041              DC.B    0, 0, 0, 0, 2, 1, 1, 1, 1, 1, 2, 0, 0, 0, 0
00001E7F= 00 00 00 02 01 01 ...   2042              DC.B    0, 0, 0, 2, 1, 1, 1, 1, 1, 1, 1, 2, 0, 0, 0
00001E8E= 00 00 02 01 01 01 ...   2043              DC.B    0, 0, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 0, 0
00001E9D= 00 02 01 03 01 01 ...   2044              DC.B    0, 2, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 0
00001EAC= 00 02 01 01 01 01 ...   2045              DC.B    0, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 0
00001EBB= 00 02 01 03 01 01 ...   2046              DC.B    0, 2, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 0
00001ECA= 00 02 01 03 03 01 ...   2047              DC.B    0, 2, 1, 3, 3, 1, 1, 2, 1, 1, 1, 1, 1, 2, 0
00001ED9= 00 00 02 01 01 01 ...   2048              DC.B    0, 0, 2, 1, 1, 1, 2, 0, 2, 1, 1, 1, 2, 0, 0
00001EE8= 00 00 00 02 02 02 ...   2049              DC.B    0, 0, 0, 2, 2, 2, 0, 0, 0, 2, 2, 2, 0, 0, 0
00001EF7= 00 00 00 00 00 00 ...   2050              DC.B    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
00001F06                          2051              
00001F06= 00000000 00000000 ...   2052  INTRO       DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00001F26= 00000000 00000000 ...   2053              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00001F46= 00000000 00000000 ...   2054              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00001F66= 00000000 00000000 ...   2055              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00001F86= 00000000 00000000 ...   2056              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00001FA6= 00000000 00000000 ...   2057              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00001FC6= 00000000 00000000 ...   2058              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00001FE6= 00000000 00000000 ...   2059              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002006= 00000000 00000000 ...   2060              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002026= 00000000 00000000 ...   2061              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002046= 00000000 00000000 ...   2062              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002066= 00000000 00000000 ...   2063              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002086= 00000000 00000000 ...   2064              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
000020A6= 00000000 00000000 ...   2065              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
000020C6= 00000000 00000000 ...   2066              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
000020E6= 00000000 00000000 ...   2067              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002106= 00000000 00000000 ...   2068              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002126= 00000000 00000000 ...   2069              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002146= 00000000 00000000 ...   2070              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002166= 00000000 00000000 ...   2071              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002186= 00000000 00000000 ...   2072              DC.L     $000000, $000000, $000000, $000000, $241ced, $241ced, $241ced, $241ced
000021A6= 00241CED 00241CED ...   2073              DC.L     $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced
000021C6= 00241CED 00241CED ...   2074              DC.L     $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced
000021E6= 00241CED 00241CED ...   2075              DC.L     $241ced, $241ced, $241ced, $241ced, $000000, $000000, $000000, $000000
00002206= 00000000 00000000 ...   2076              DC.L     $000000, $000000, $000000, $000000, $241ced, $00ffff, $00ffff, $00ffff
00002226= 00241CED 0000FFFF ...   2077              DC.L     $241ced, $00ffff, $00ffff, $00ffff, $00ffff, $241ced, $00ffff, $00ffff
00002246= 0000FFFF 0000FFFF ...   2078              DC.L     $00ffff, $00ffff, $241ced, $00ffff, $00ffff, $00ffff, $241ced, $00ffff
00002266= 0000FFFF 0000FFFF ...   2079              DC.L     $00ffff, $00ffff, $00ffff, $241ced, $000000, $000000, $000000, $000000
00002286= 00000000 00000000 ...   2080              DC.L     $000000, $000000, $000000, $000000, $241ced, $00ffff, $241ced, $241ced
000022A6= 00241CED 0000FFFF ...   2081              DC.L     $241ced, $00ffff, $241ced, $241ced, $00ffff, $241ced, $00ffff, $241ced
000022C6= 00241CED 0000FFFF ...   2082              DC.L     $241ced, $00ffff, $241ced, $00ffff, $241ced, $241ced, $241ced, $00ffff
000022E6= 00241CED 00241CED ...   2083              DC.L     $241ced, $241ced, $241ced, $241ced, $000000, $000000, $000000, $000000
00002306= 00000000 00000000 ...   2084              DC.L     $000000, $000000, $000000, $000000, $241ced, $00ffff, $241ced, $241ced
00002326= 00241CED 0000FFFF ...   2085              DC.L     $241ced, $00ffff, $241ced, $241ced, $00ffff, $241ced, $00ffff, $241ced
00002346= 00241CED 0000FFFF ...   2086              DC.L     $241ced, $00ffff, $241ced, $00ffff, $241ced, $241ced, $241ced, $00ffff
00002366= 00241CED 00241CED ...   2087              DC.L     $241ced, $241ced, $241ced, $241ced, $000000, $000000, $000000, $000000
00002386= 00000000 00000000 ...   2088              DC.L     $000000, $000000, $000000, $000000, $241ced, $00ffff, $241ced, $241ced
000023A6= 00241CED 0000FFFF ...   2089              DC.L     $241ced, $00ffff, $241ced, $241ced, $00ffff, $241ced, $00ffff, $241ced
000023C6= 00241CED 0000FFFF ...   2090              DC.L     $241ced, $00ffff, $241ced, $00ffff, $241ced, $241ced, $241ced, $00ffff
000023E6= 00241CED 00241CED ...   2091              DC.L     $241ced, $241ced, $241ced, $241ced, $000000, $000000, $000000, $000000
00002406= 00000000 00000000 ...   2092              DC.L     $000000, $000000, $000000, $000000, $241ced, $00ffff, $241ced, $241ced
00002426= 00241CED 0000FFFF ...   2093              DC.L     $241ced, $00ffff, $241ced, $241ced, $00ffff, $241ced, $00ffff, $241ced
00002446= 00241CED 0000FFFF ...   2094              DC.L     $241ced, $00ffff, $241ced, $00ffff, $241ced, $241ced, $241ced, $00ffff
00002466= 00241CED 00241CED ...   2095              DC.L     $241ced, $241ced, $241ced, $241ced, $000000, $000000, $000000, $000000
00002486= 00000000 00000000 ...   2096              DC.L     $000000, $000000, $000000, $000000, $241ced, $00ffff, $00ffff, $00ffff
000024A6= 00241CED 0000FFFF ...   2097              DC.L     $241ced, $00ffff, $00ffff, $00ffff, $00ffff, $241ced, $00ffff, $00ffff
000024C6= 0000FFFF 0000FFFF ...   2098              DC.L     $00ffff, $00ffff, $241ced, $00ffff, $241ced, $241ced, $241ced, $00ffff
000024E6= 0000FFFF 0000FFFF ...   2099              DC.L     $00ffff, $00ffff, $241ced, $241ced, $000000, $000000, $000000, $000000
00002506= 00000000 00000000 ...   2100              DC.L     $000000, $000000, $000000, $000000, $241ced, $241ced, $241ced, $00ffff
00002526= 00241CED 0000FFFF ...   2101              DC.L     $241ced, $00ffff, $241ced, $241ced, $241ced, $241ced, $00ffff, $241ced
00002546= 00241CED 0000FFFF ...   2102              DC.L     $241ced, $00ffff, $241ced, $00ffff, $241ced, $241ced, $241ced, $00ffff
00002566= 00241CED 00241CED ...   2103              DC.L     $241ced, $241ced, $241ced, $241ced, $000000, $000000, $000000, $000000
00002586= 00000000 00000000 ...   2104              DC.L     $000000, $000000, $000000, $000000, $241ced, $241ced, $241ced, $00ffff
000025A6= 00241CED 0000FFFF ...   2105              DC.L     $241ced, $00ffff, $241ced, $241ced, $241ced, $241ced, $00ffff, $241ced
000025C6= 00241CED 0000FFFF ...   2106              DC.L     $241ced, $00ffff, $241ced, $00ffff, $241ced, $241ced, $241ced, $00ffff
000025E6= 00241CED 00241CED ...   2107              DC.L     $241ced, $241ced, $241ced, $241ced, $000000, $000000, $000000, $000000
00002606= 00000000 00000000 ...   2108              DC.L     $000000, $000000, $000000, $000000, $241ced, $241ced, $241ced, $00ffff
00002626= 00241CED 0000FFFF ...   2109              DC.L     $241ced, $00ffff, $241ced, $241ced, $241ced, $241ced, $00ffff, $241ced
00002646= 00241CED 0000FFFF ...   2110              DC.L     $241ced, $00ffff, $241ced, $00ffff, $241ced, $241ced, $241ced, $00ffff
00002666= 00241CED 00241CED ...   2111              DC.L     $241ced, $241ced, $241ced, $241ced, $000000, $000000, $000000, $000000
00002686= 00000000 00000000 ...   2112              DC.L     $000000, $000000, $000000, $000000, $241ced, $241ced, $241ced, $00ffff
000026A6= 00241CED 0000FFFF ...   2113              DC.L     $241ced, $00ffff, $241ced, $241ced, $241ced, $241ced, $00ffff, $241ced
000026C6= 00241CED 0000FFFF ...   2114              DC.L     $241ced, $00ffff, $241ced, $00ffff, $241ced, $241ced, $241ced, $00ffff
000026E6= 00241CED 00241CED ...   2115              DC.L     $241ced, $241ced, $241ced, $241ced, $000000, $000000, $000000, $000000
00002706= 00000000 00000000 ...   2116              DC.L     $000000, $000000, $000000, $000000, $241ced, $00ffff, $00ffff, $00ffff
00002726= 00241CED 0000FFFF ...   2117              DC.L     $241ced, $00ffff, $241ced, $241ced, $241ced, $241ced, $00ffff, $241ced
00002746= 00241CED 0000FFFF ...   2118              DC.L     $241ced, $00ffff, $241ced, $00ffff, $00ffff, $00ffff, $241ced, $00ffff
00002766= 0000FFFF 0000FFFF ...   2119              DC.L     $00ffff, $00ffff, $00ffff, $241ced, $000000, $000000, $000000, $000000
00002786= 00000000 00000000 ...   2120              DC.L     $000000, $000000, $000000, $000000, $241ced, $241ced, $241ced, $241ced
000027A6= 00241CED 00241CED ...   2121              DC.L     $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced
000027C6= 00241CED 00241CED ...   2122              DC.L     $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced
000027E6= 00241CED 00241CED ...   2123              DC.L     $241ced, $241ced, $241ced, $241ced, $000000, $000000, $000000, $000000
00002806= 00000000 00000000 ...   2124              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002826= 00000000 00000000 ...   2125              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002846= 00000000 00000000 ...   2126              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002866= 00000000 00000000 ...   2127              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002886= 00000000 00000000 ...   2128              DC.L     $000000, $000000, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced
000028A6= 00241CED 00241CED ...   2129              DC.L     $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced
000028C6= 00241CED 00241CED ...   2130              DC.L     $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced
000028E6= 00241CED 00241CED ...   2131              DC.L     $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $000000, $000000
00002906= 00000000 00000000 ...   2132              DC.L     $000000, $000000, $241ced, $00ffff, $00ffff, $241ced, $00ffff, $241ced
00002926= 0000FFFF 00241CED ...   2133              DC.L     $00ffff, $241ced, $00ffff, $00ffff, $00ffff, $241ced, $00ffff, $00ffff
00002946= 0000FFFF 00241CED ...   2134              DC.L     $00ffff, $241ced, $00ffff, $00ffff, $00ffff, $241ced, $00ffff, $00ffff
00002966= 0000FFFF 00241CED ...   2135              DC.L     $00ffff, $241ced, $00ffff, $00ffff, $241ced, $241ced, $000000, $000000
00002986= 00000000 00000000 ...   2136              DC.L     $000000, $000000, $241ced, $00ffff, $241ced, $241ced, $00ffff, $241ced
000029A6= 0000FFFF 00241CED ...   2137              DC.L     $00ffff, $241ced, $00ffff, $241ced, $00ffff, $241ced, $00ffff, $241ced
000029C6= 0000FFFF 00241CED ...   2138              DC.L     $00ffff, $241ced, $241ced, $00ffff, $241ced, $241ced, $00ffff, $241ced
000029E6= 00241CED 00241CED ...   2139              DC.L     $241ced, $241ced, $00ffff, $241ced, $00ffff, $241ced, $000000, $000000
00002A06= 00000000 00000000 ...   2140              DC.L     $000000, $000000, $241ced, $00ffff, $00ffff, $241ced, $00ffff, $00ffff
00002A26= 0000FFFF 00241CED ...   2141              DC.L     $00ffff, $241ced, $00ffff, $241ced, $00ffff, $241ced, $00ffff, $241ced
00002A46= 0000FFFF 00241CED ...   2142              DC.L     $00ffff, $241ced, $241ced, $00ffff, $241ced, $241ced, $00ffff, $00ffff
00002A66= 00241CED 00241CED ...   2143              DC.L     $241ced, $241ced, $00ffff, $00ffff, $241ced, $241ced, $000000, $000000
00002A86= 00000000 00000000 ...   2144              DC.L     $000000, $000000, $241ced, $241ced, $00ffff, $241ced, $00ffff, $241ced
00002AA6= 0000FFFF 00241CED ...   2145              DC.L     $00ffff, $241ced, $00ffff, $241ced, $00ffff, $241ced, $00ffff, $241ced
00002AC6= 0000FFFF 00241CED ...   2146              DC.L     $00ffff, $241ced, $241ced, $00ffff, $241ced, $241ced, $00ffff, $241ced
00002AE6= 00241CED 00241CED ...   2147              DC.L     $241ced, $241ced, $00ffff, $241ced, $00ffff, $241ced, $000000, $000000
00002B06= 00000000 00000000 ...   2148              DC.L     $000000, $000000, $241ced, $00ffff, $00ffff, $241ced, $00ffff, $241ced
00002B26= 0000FFFF 00241CED ...   2149              DC.L     $00ffff, $241ced, $00ffff, $00ffff, $00ffff, $241ced, $00ffff, $00ffff
00002B46= 0000FFFF 00241CED ...   2150              DC.L     $00ffff, $241ced, $241ced, $00ffff, $241ced, $241ced, $00ffff, $00ffff
00002B66= 0000FFFF 00241CED ...   2151              DC.L     $00ffff, $241ced, $00ffff, $241ced, $00ffff, $241ced, $000000, $000000
00002B86= 00000000 00000000 ...   2152              DC.L     $000000, $000000, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced
00002BA6= 00241CED 00241CED ...   2153              DC.L     $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced
00002BC6= 00241CED 00241CED ...   2154              DC.L     $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $241ced
00002BE6= 00241CED 00241CED ...   2155              DC.L     $241ced, $241ced, $241ced, $241ced, $241ced, $241ced, $000000, $000000
00002C06= 00000000 00000000 ...   2156              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002C26= 00000000 00000000 ...   2157              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002C46= 00000000 00000000 ...   2158              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002C66= 00000000 00000000 ...   2159              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002C86= 00000000 00000000 ...   2160              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002CA6= 00000000 00000000 ...   2161              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002CC6= 00000000 00000000 ...   2162              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002CE6= 00000000 00000000 ...   2163              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002D06= 00000000 00000000 ...   2164              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002D26= 00000000 00000000 ...   2165              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002D46= 00000000 00000000 ...   2166              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002D66= 00000000 00000000 ...   2167              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002D86= 00000000 00000000 ...   2168              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002DA6= 00000000 00000000 ...   2169              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002DC6= 00000000 00000000 ...   2170              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002DE6= 00000000 00000000 ...   2171              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002E06= 00000000 00000000 ...   2172              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002E26= 00000000 00000000 ...   2173              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002E46= 00000000 00000000 ...   2174              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002E66= 00000000 00000000 ...   2175              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002E86= 00000000 00000000 ...   2176              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002EA6= 00000000 00000000 ...   2177              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002EC6= 00000000 00000000 ...   2178              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002EE6= 00000000 00000000 ...   2179              DC.L     $000000, $000000, $000000, $000000, $000000, $000000, $000000, $000000
00002F06                          2180              
00002F06                          2181  
00002F06                          2182  
00002F06                          2183  
00002F06                          2184  -------------------- end include --------------------
00002F06                          2185              INCLUDE "AUDIO.X68"             ; GESTIÓN DE AUDIO
00002F06                          2186  ; =============================================================================
00002F06                          2187  ; GESTIÓN DE AUDIO
00002F06                          2188  ; =============================================================================
00002F06                          2189  
00002F06                          2190  ; -----------------------------------------------------------------------------
00002F06                          2191  AUDINIT
00002F06                          2192  ; INICIALIZA EL GESTOR DE AUDIO
00002F06                          2193  ; ENTRADA  - NINGUNA
00002F06                          2194  ; SALIDA   - NINGUNA
00002F06                          2195  ; MODIFICA - NINGUNA
00002F06                          2196  ; -----------------------------------------------------------------------------
00002F06  48E7 C0E0               2197              MOVEM.L D0-D1/A0-A2,-(A7)
00002F0A                          2198              
00002F0A  41F9 00002F36           2199              LEA     .AUDLIST,A0
00002F10  45F9 00002FD3           2200              LEA     .IDLIST,A2
00002F16                          2201              
00002F16  2018                    2202  .LOOP       MOVE.L  (A0)+,D0                ; CARGA TODOS LOS ARCHIVOS DE AUDIO
00002F18  6700 000E               2203              BEQ     .END
00002F1C  121A                    2204              MOVE.B  (A2)+,D1
00002F1E  2240                    2205              MOVE.L  D0,A1
00002F20  103C 0047               2206              MOVE.B  #71,D0
00002F24  4E4F                    2207              TRAP    #15
00002F26  60EE                    2208              BRA     .LOOP
00002F28                          2209              
00002F28  13FC 00FF 00003F5A      2210  .END        MOVE.B  #AUDACCY,(AUDACCSN)     ; COMIENZA ACEPTANDO SONIDOS
00002F30  4CDF 0703               2211              MOVEM.L (A7)+,D0-D1/A0-A2
00002F34  4E75                    2212              RTS
00002F36                          2213              
00002F36= 00002F56 00002F67 ...   2214  .AUDLIST    DC.L    .INTRO,.SHOT,.IMPACT,.HERIDO,.GAMEOVER,.CNTDWN,.CNTDWNF,0
00002F56= 53 4F 55 4E 44 53 ...   2215  .INTRO      DC.B    'SOUNDS/INTRO.WAV',0
00002F67= 53 4F 55 4E 44 53 ...   2216  .SHOT       DC.B    'SOUNDS/SHOT.WAV',0
00002F77= 53 4F 55 4E 44 53 ...   2217  .IMPACT     DC.B    'SOUNDS/IMPACT.WAV',0
00002F89= 53 4F 55 4E 44 53 ...   2218  .HERIDO     DC.B    'SOUNDS/HERIDO.WAV',0
00002F9B= 53 4F 55 4E 44 53 ...   2219  .GAMEOVER   DC.B    'SOUNDS/GAMEOVER.WAV',0
00002FAF= 53 4F 55 4E 44 53 ...   2220  .CNTDWN     DC.B    'SOUNDS/COUNTDOWN.WAV',0
00002FC4= 53 4F 55 4E 44 53 ...   2221  .CNTDWNF    DC.B    'SOUNDS/SUI.WAV',0
00002FD3= 00 01 02 03 04 05 06    2222  .IDLIST     DC.B    AUDINTID,AUDSHTID,AUDIMPID,AUDHERID,AUDGOVID,AUDCDNID,AUDCDFID
00002FDA                          2223              DS.W    0
00002FDA                          2224  
00002FDA                          2225  ; -----------------------------------------------------------------------------
00002FDA                          2226  AUDPLAY
00002FDA                          2227  ; CAMBIA EL AUDIO A REPRODUCIR
00002FDA                          2228  ; ENTRADA  - D1.B   BIT 7=1 BUCLE, BIT 7=0 REPRODUCIR SOLO UNA VEZ
00002FDA                          2229  ;                   BITS 6-0 ID DE SONIDO
00002FDA                          2230  ; SALIDA   - NINGUNA
00002FDA                          2231  ; MODIFICA - NINGUNA
00002FDA                          2232  ; -----------------------------------------------------------------------------
00002FDA  0C39 0000 00003F5A      2233              CMP.B   #AUDACCN,(AUDACCSN)     ; VERIFICA SI SE ACEPTAN SONIDOS
00002FE2  6700 002C               2234              BEQ     .END                    ; NO: FIN
00002FE6  48E7 E000               2235              MOVEM.L D0-D2,-(A7)
00002FEA  103C 004C               2236              MOVE.B  #76,D0
00002FEE  7403                    2237              MOVE.L  #3,D2
00002FF0  4E4F                    2238              TRAP    #15                     ; DETIENE TODOS LOS SONIDOS
00002FF2  4282                    2239              CLR.L   D2
00002FF4  0881 0007               2240              BCLR    #7,D1                   ; LIMPIA MSB Y VERIFICA
00002FF8  6700 0004               2241              BEQ     .CONT                   ; SI ES CERO, CONTINUA
00002FFC  5242                    2242              ADDQ.W  #1,D2                   ; SI ES UNO, ACTIVA BUCLE
00002FFE  B23C 00FF               2243  .CONT       CMP.B   #AUDENDID,D1            ; ¿ES EL ID DE SONIDO DE PARADA?
00003002  6700 0008               2244              BEQ     .DONE                   ; NO REPRODUCIR
00003006  103C 004C               2245              MOVE.B  #76,D0                  ; SELECCIONA EL REPRODUCT. ESTÁNDAR
0000300A  4E4F                    2246              TRAP    #15                     ; Y REPRODUCE
0000300C  4CDF 0007               2247  .DONE       MOVEM.L (A7)+,D0-D2
00003010  4E75                    2248  .END        RTS
00003012                          2249  
00003012                          2250  -------------------- end include --------------------
00003012                          2251              INCLUDE "COUNTDOWN.X68"         ; MANEJADOR DE LA CUENTA REGRESIVA
00003012                          2252  ; =============================================================================
00003012                          2253  ; MANEJADOR DE LA CUENTA REGRESIVA
00003012                          2254  ; =============================================================================
00003012                          2255  
00003012                          2256  ; -----------------------------------------------------------------------------
00003012                          2257  CUREUPD
00003012                          2258  ; ACTUALIZACIÓN DE LA CUENTA REGRESIVA
00003012                          2259  ; ENTRADA - NINGUNA
00003012                          2260  ; SALIDA   - NINGUNA
00003012                          2261  ; MODIFICA - NINGUNA
00003012                          2262  ; -----------------------------------------------------------------------------
00003012  48E7 F800               2263              MOVEM.L D0-D4,-(A7)
00003016                          2264              
00003016  5239 00003F5C           2265              ADDQ.B  #1,(CICLOCR)  
0000301C                          2266                     
0000301C  0C39 003F 00003F5C      2267              CMP.B    #$3F,(CICLOCR)
00003024  6700 0104               2268              BEQ     .NEXT
00003028                          2269              
00003028                          2270              ; IMPRIMIMOS POR PANTALLA EL NUMERO
00003028                          2271m             UTLSPEN     #NUMCOLOR
00003028                          2272m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL LÁPIZ.
00003028                          2273m ; ENTRADA  - #NUMCOLOR COLOR EN FORMATO $00BBGGRR
00003028                          2274m ; SALIDA   - NINGUNA
00003028                          2275m ; MODIFICA - D0,D1
00003028                          2276m ; -----------------------------------------------------------------------------
00003034                          2277m             UTLSFIL     #NUMCOLOR
00003034                          2278m ; ENVOLTORIO PARA LA TAREA TRAP 15 DE ESTABLECER EL RELLENO.
00003034                          2279m ; ENTRADA  - #NUMCOLOR COLOR EN FORMATO $00BBGGRR
00003034                          2280m ; SALIDA   - NINGUNA
00003034                          2281m ; MODIFICA - D0,D1
00003034                          2282m ; -----------------------------------------------------------------------------
00003040                          2283              
00003040                          2284              ; MIRAMOS SI ES EL 1
00003040  0C39 0001 00003F5D      2285              CMP.B   #1,(NUMACTCR)
00003048  6600 0020               2286              BNE     .ES2
0000304C                          2287              
0000304C                          2288              ;PINTAMOS 1
0000304C  323C 0131               2289              MOVE.W  #(SCRWIDTH/2)-(NUMSIZE/2),D1
00003050  343C 00AA               2290              MOVE.W  #(SCRHEIGH/2)-(NUMHEIGH/2),D2
00003054  3601                    2291              MOVE.W  D1,D3
00003056  0643 001E               2292              ADD.W   #NUMSIZE,D3
0000305A  3802                    2293              MOVE.W  D2,D4
0000305C  0644 012C               2294              ADD.W   #NUMHEIGH,D4
00003060                          2295              
00003060  103C 0057               2296              MOVE.B      #87,D0
00003064  4E4F                    2297              TRAP        #15
00003066                          2298              
00003066  6000 00FC               2299              BRA     .END
0000306A                          2300  
0000306A                          2301              ; MIRAMOS SI ES EL 2
0000306A  0C39 0002 00003F5D      2302  .ES2        CMP.B   #2,(NUMACTCR)
00003072  6600 0062               2303              BNE     .ES3   
00003076                          2304  
00003076                          2305              ;PINTAMOS 2  
00003076  323C 00DC               2306              MOVE.W  #(SCRWIDTH/2)-(NUMWIDTH/2),D1   ; BARRA DE ARRIBA
0000307A  343C 00AA               2307              MOVE.W  #(SCRHEIGH/2)-(NUMHEIGH/2),D2
0000307E  3601                    2308              MOVE.W  D1,D3
00003080  0643 00C8               2309              ADD.W   #NUMWIDTH,D3
00003084  3802                    2310              MOVE.W  D2,D4
00003086  0644 001E               2311              ADD.W   #NUMSIZE,D4
0000308A                          2312              
0000308A  103C 0057               2313              MOVE.B      #87,D0
0000308E  4E4F                    2314              TRAP        #15
00003090                          2315              
00003090  0642 0087               2316              ADD.W   #(NUMHEIGH/2)-(NUMSIZE/2),D2    ; BARRA DE ENMEDIO
00003094  0644 0087               2317              ADD.W   #(NUMHEIGH/2)-(NUMSIZE/2),D4
00003098                          2318              
00003098  103C 0057               2319              MOVE.B      #87,D0
0000309C  4E4F                    2320              TRAP        #15
0000309E                          2321              
0000309E  0642 0087               2322              ADD.W   #(NUMHEIGH/2)-(NUMSIZE/2),D2    ; BARRA DE ABAJO
000030A2  0644 0087               2323              ADD.W   #(NUMHEIGH/2)-(NUMSIZE/2),D4
000030A6                          2324              
000030A6  103C 0057               2325              MOVE.B      #87,D0
000030AA  4E4F                    2326              TRAP        #15
000030AC                          2327              
000030AC  0641 00AA               2328              ADD.W   #NUMWIDTH-NUMSIZE,D1            ; BARRA DE LA DERECHA
000030B0  343C 00AA               2329              MOVE.W  #(SCRHEIGH/2)-(NUMHEIGH/2),D2
000030B4  383C 014F               2330              MOVE.W  #(SCRHEIGH/2)+(NUMSIZE/2),D4
000030B8                          2331              
000030B8  103C 0057               2332              MOVE.B      #87,D0
000030BC  4E4F                    2333              TRAP        #15
000030BE                          2334              
000030BE  0441 00AA               2335              SUB.W   #NUMWIDTH-NUMSIZE,D1            ; BARRA DE LA IZQUIERDA
000030C2  3404                    2336              MOVE.W  D4,D2
000030C4  0443 00AA               2337              SUB.W   #NUMWIDTH-NUMSIZE,D3
000030C8  0644 0087               2338              ADD.W   #(NUMHEIGH/2)-(NUMSIZE/2),D4
000030CC                          2339              
000030CC  103C 0057               2340              MOVE.B      #87,D0
000030D0  4E4F                    2341              TRAP        #15
000030D2                          2342              
000030D2  6000 0090               2343              BRA     .END
000030D6                          2344  
000030D6                          2345              ; MIRAMOS SI ES EL 3
000030D6  0C39 0003 00003F5D      2346  .ES3        CMP.B   #3,(NUMACTCR)
000030DE  6600 0084               2347              BNE     .END   
000030E2                          2348  
000030E2                          2349              ;PINTAMOS 3
000030E2  323C 00DC               2350              MOVE.W  #(SCRWIDTH/2)-(NUMWIDTH/2),D1   ; BARRA DE ARRIBA
000030E6  343C 00AA               2351              MOVE.W  #(SCRHEIGH/2)-(NUMHEIGH/2),D2
000030EA  3601                    2352              MOVE.W  D1,D3
000030EC  0643 00C8               2353              ADD.W   #NUMWIDTH,D3
000030F0  3802                    2354              MOVE.W  D2,D4
000030F2  0644 001E               2355              ADD.W   #NUMSIZE,D4
000030F6                          2356              
000030F6  103C 0057               2357              MOVE.B      #87,D0
000030FA  4E4F                    2358              TRAP        #15
000030FC                          2359              
000030FC  0642 0087               2360              ADD.W   #(NUMHEIGH/2)-(NUMSIZE/2),D2    ; BARRA DE ENMEDIO
00003100  0644 0087               2361              ADD.W   #(NUMHEIGH/2)-(NUMSIZE/2),D4
00003104                          2362              
00003104  103C 0057               2363              MOVE.B      #87,D0
00003108  4E4F                    2364              TRAP        #15
0000310A                          2365              
0000310A  0642 0087               2366              ADD.W   #(NUMHEIGH/2)-(NUMSIZE/2),D2    ; BARRA DE ABAJO
0000310E  0644 0087               2367              ADD.W   #(NUMHEIGH/2)-(NUMSIZE/2),D4
00003112                          2368              
00003112  103C 0057               2369              MOVE.B      #87,D0
00003116  4E4F                    2370              TRAP        #15
00003118                          2371              
00003118  0641 00AA               2372              ADD.W   #NUMWIDTH-NUMSIZE,D1            ; BARRA DEL LATERAL
0000311C  0442 010E               2373              SUB.W   #NUMHEIGH-NUMSIZE,D2
00003120                          2374              
00003120  103C 0057               2375              MOVE.B      #87,D0
00003124  4E4F                    2376              TRAP        #15
00003126                          2377              
00003126  6000 003C               2378              BRA     .END
0000312A                          2379              
0000312A                          2380              
0000312A                          2381              ; MODIFICAMOS CUENTA REGRESIVA
0000312A  5339 00003F5D           2382  .NEXT       SUBQ.B  #1,(NUMACTCR)
00003130  4239 00003F5C           2383              CLR.B   (CICLOCR)
00003136                          2384              
00003136  4A39 00003F5D           2385              TST.B   (NUMACTCR)
0000313C  6700 0016               2386              BEQ     .FINAL
00003140                          2387              
00003140                          2388              ; MUSICA            
00003140  123C 0005               2389              MOVE.B  #AUDMSKNL|AUDCDNID,D1
00003144  4EB8 2FDA               2390              JSR     AUDPLAY                 ; PLAY MUSIC
00003148  13FC 00FF 00003F5A      2391              MOVE.B  #AUDACCY,(AUDACCSN)     ; REJECT SOUND EFFECTS
00003150  6000 0012               2392              BRA     .END
00003154                          2393              
00003154                          2394  .FINAL      ; MUSICA            
00003154  123C 0006               2395              MOVE.B  #AUDMSKNL|AUDCDFID,D1
00003158  4EB8 2FDA               2396              JSR     AUDPLAY                 ; PLAY MUSIC
0000315C  13FC 00FF 00003F5A      2397              MOVE.B  #AUDACCY,(AUDACCSN)     ; REJECT SOUND EFFECTS
00003164                          2398              
00003164  4CDF 001F               2399  .END        MOVEM.L  (A7)+,D0-D4
00003168  4E75                    2400              RTS
0000316A                          2401  
0000316A                          2402  -------------------- end include --------------------
0000316A                          2403              INCLUDE "DATA/RECORDSCORE.X68"  ; MANEJADOR DEL ARCHIVO DE PUNTUAC
0000316A                          2404  ; =============================================================================
0000316A                          2405  ; MANEJO DE ARCHIVO DE PUNTUACIONES
0000316A                          2406  ; =============================================================================
0000316A                          2407  
0000316A                          2408  ; -----------------------------------------------------------------------------
0000316A                          2409  SCOUPD
0000316A                          2410  ; ACTUALIZA ARCHIVO DE PUNTUACIONES
0000316A                          2411  ; ENTRADA  - NINGUNA
0000316A                          2412  ; SALIDA   - NINGUNA
0000316A                          2413  ; MODIFICA - NINGUNA
0000316A                          2414  ; -----------------------------------------------------------------------------
0000316A                          2415  
0000316A  48E7 F080               2416              MOVEM.L D0-D3/A0,-(A7)
0000316E                          2417                          
0000316E  4EB9 000031DC           2418              JSR     SCOREAD             ; LEEMOS ARCHIVO
00003174                          2419              
00003174  4282                    2420              CLR.L   D2                  ; PUNTERO EN ARCHIVO           
00003176                          2421              
00003176  41F9 00003F60           2422              LEA     FILEBUFF,A0         ; PUNTERO AL BUFFER
0000317C                          2423              
0000317C  3639 00003F56           2424  .LOOP       MOVE.W  (PLRSCORE),D3       ; PUNTUACIÓN DEL JUGADOR
00003182  B650                    2425              CMP.W   (A0),D3             ; VEMOS SI ES MÁS GRANDE
00003184  6E00 0006               2426              BGT     .ESMAYOR
00003188  6000 0010               2427              BRA     .NEXT
0000318C                          2428              
0000318C  4EB9 000031AA           2429  .ESMAYOR    JSR     SCOREC              ; LO GUARDAMOS
00003192  3610                    2430              MOVE.W  (A0),D3             ; Y GUARDAMOS EL QUE HABÍA ANTES
00003194  33C3 00003F56           2431              MOVE.W  D3,(PLRSCORE)
0000319A                          2432  
0000319A  5488                    2433  .NEXT       ADDQ.L  #2,A0
0000319C  5402                    2434              ADDQ.B  #2,D2
0000319E                          2435  
0000319E  B43C 0006               2436              CMP.B   #2*NUMSCOS,D2
000031A2  65D8                    2437              BLO     .LOOP
000031A4                          2438              
000031A4  4CDF 010F               2439              MOVEM.L (A7)+,D0-D3/A0
000031A8                          2440              
000031A8  4E75                    2441              RTS
000031AA                          2442  
000031AA                          2443  
000031AA                          2444  ; -----------------------------------------------------------------------------
000031AA                          2445  SCOREC
000031AA                          2446  ; GUARDA PUNTUACIÓN
000031AA                          2447  ; ENTRADA  - D2.L -> PUNTERO A POSICIÓN DEL ARCHIVO
000031AA                          2448  ; SALIDA   - NINGUNA
000031AA                          2449  ; MODIFICA - NINGUNA
000031AA                          2450  ; -----------------------------------------------------------------------------
000031AA                          2451  
000031AA  48E7 C040               2452              MOVEM.L D0-D1/A1,-(A7)
000031AE                          2453                          
000031AE  43F8 11D6               2454              LEA     FNAME,A1            ; ABRIMOS EL ARCHIVO
000031B2  103C 0033               2455              MOVE.B  #51,D0
000031B6  4E4F                    2456              TRAP    #15
000031B8                          2457              
000031B8  103C 0037               2458              MOVE.B  #55,D0              ; PUNTERO
000031BC  4E4F                    2459              TRAP    #15
000031BE                          2460              
000031BE  2F02                    2461              MOVE.L  D2,-(A7)
000031C0                          2462              
000031C0  7402                    2463              MOVEQ.L #2,D2               ; BYTES A ESCRIBIR
000031C2  43F9 00003F56           2464              LEA     PLRSCORE,A1         ; ESCRIBIMOS EN EL ARCHIVO
000031C8  103C 0036               2465              MOVE.B  #54,D0
000031CC  4E4F                    2466              TRAP    #15
000031CE                          2467              
000031CE  241F                    2468              MOVE.L  (A7)+,D2
000031D0                          2469              
000031D0  103C 0038               2470              MOVE.B  #56,D0              ; CERRAMOS EL ARCHIVO
000031D4  4E4F                    2471              TRAP    #15
000031D6                          2472              
000031D6  4CDF 0203               2473              MOVEM.L (A7)+,D0-D1/A1
000031DA                          2474              
000031DA  4E75                    2475              RTS
000031DC                          2476              
000031DC                          2477  ; -----------------------------------------------------------------------------
000031DC                          2478  SCOREAD
000031DC                          2479  ; LEE ARCHIVO DE PUNTUACIONES
000031DC                          2480  ; ENTRADA  - NINGUNA
000031DC                          2481  ; SALIDA   - NINGUNA
000031DC                          2482  ; MODIFICA - NINGUNA
000031DC                          2483  ; -----------------------------------------------------------------------------
000031DC                          2484              
000031DC  48E7 E040               2485              MOVEM.L D0-D2/A1,-(A7)
000031E0                          2486              
000031E0                          2487              ; LIMPIAMOS BUFFER
000031E0  4280                    2488              CLR.L   D0
000031E2  41F9 00003F60           2489              LEA     FILEBUFF,A0
000031E8                          2490              
000031E8  4258                    2491  .LOOP       CLR.W   (A0)+
000031EA                          2492              
000031EA  5200                    2493              ADDQ.B  #1,D0
000031EC                          2494              
000031EC  B03C 0003               2495              CMP.B   #NUMSCOS,D0
000031F0  66F6                    2496              BNE     .LOOP
000031F2                          2497              
000031F2                          2498              
000031F2                          2499              ; LEEMOS ARCHIVO
000031F2  43F8 11D6               2500              LEA     FNAME,A1            ; ABRIMOS EL ARCHIVO
000031F6  103C 0033               2501              MOVE.B  #51,D0
000031FA  4E4F                    2502              TRAP    #15
000031FC                          2503              
000031FC  4282                    2504              CLR.L   D2                  ; PUNTERO
000031FE  103C 0037               2505              MOVE.B  #55,D0
00003202  4E4F                    2506              TRAP    #15
00003204                          2507              
00003204  43F9 00003F60           2508              LEA     FILEBUFF,A1         ; LEEMOS EL ARCHIVO
0000320A  7406                    2509              MOVE.L  #2*NUMSCOS,D2       ; BYTES A LEER
0000320C                          2510              
0000320C  103C 0035               2511              MOVE.B  #53,D0              ; LEEMOS
00003210  4E4F                    2512              TRAP    #15
00003212                          2513                         
00003212  103C 0038               2514              MOVE.B  #56,D0              ; CERRAMOS EL ARCHIVO
00003216  4E4F                    2515              TRAP    #15
00003218                          2516              
00003218  4CDF 0207               2517              MOVEM.L (A7)+,D0-D2/A1
0000321C                          2518              
0000321C                          2519              
0000321C  4E75                    2520              RTS
0000321E                          2521  
0000321E                          2522              
0000321E                          2523              
0000321E                          2524  
0000321E                          2525  
0000321E                          2526  
0000321E                          2527  
0000321E                          2528  
0000321E                          2529  -------------------- end include --------------------
0000321E                          2530              
0000321E                          2531  
0000321E                          2532  ; --- INICIALIZACIÓN ----------------------------------------------------------
0000321E                          2533  
0000321E  4EB8 1000               2534  START       JSR     SYSINIT                 ; INICIALIZA EL CÓDIGO DEL SISTEMA
00003222  4EB8 1A60               2535              JSR     STAINIT                 ; INICIALIZA EL ESTADO DEL JUEGO
00003226  4EB8 2F06               2536              JSR     AUDINIT                 ; INICIALIZA EL GESTOR DE AUDIO
0000322A                          2537              
0000322A                          2538              ; INICIALIZAMOS FRAMES POR SEGUNDO
0000322A  42B9 00003F48           2539              CLR.L   (FPSCOUNT)
00003230  23FC 0000001E 00003F44  2540              MOVE.L  #FPSGOAL,(FPSREAL)
0000323A  103C 0008               2541              MOVE.B  #8,D0                   ; OBTENEMOS TIEMPO
0000323E  4E4F                    2542              TRAP    #15
00003240  23C1 00003F4C           2543              MOVE.L  D1,(TIME)
00003246                          2544  
00003246                          2545  ; --- ACTUALIZACIÓN -----------------------------------------------------------
00003246                          2546  
00003246  4E40                    2547  .LOOP       TRAP    #KBDTRAP                ; LEE EL TECLADO
00003248  4EB8 1A78               2548              JSR     STAUPD                  ; ACTUALIZA DEPENDIENDO DEL ESTADO
0000324C                          2549  
0000324C                          2550  ; --- ESPERA SINCRONIZACIÓN ---------------------------------------------------
0000324C                          2551  
0000324C  4A39 000032A0           2552  .WINT       TST.B   (SCRINTCT)              ; ESPERA A LA INTERRUPCIÓN
00003252  67F8                    2553              BEQ     .WINT
00003254  4239 000032A0           2554              CLR.B   (SCRINTCT)
0000325A                          2555  
0000325A                          2556  ; --- TRAZADO -----------------------------------------------------------------
0000325A                          2557  
0000325A  4EB8 1ACE               2558              JSR     STAPLOT                 ; TRAZA DEPENDIENDO DEL ESTADO
0000325E  4E41                    2559              TRAP    #SCRTRAP                ; MUESTRA GRÁFICOS
00003260                          2560              
00003260                          2561              ; ACTUALIZAMOS FPS
00003260  103C 0008               2562              MOVE.B  #8,D0                   ; OBTENEMOS TIEMPO
00003264  4E4F                    2563              TRAP    #15
00003266  92B9 00003F4C           2564              SUB.L   (TIME),D1               ; OBTENEMOS DIFERENCIA DE TIEMPO
0000326C                          2565              
0000326C  52B9 00003F48           2566              ADDQ.L  #1,(FPSCOUNT)           ; AÑADIMOS FRAME
00003272                          2567              
00003272  B2BC 00000064           2568              CMP.L   #100,D1                 ; VEMOS SI HA PASADO 1 SEGUNDO
00003278  6500 001E               2569              BLO     .NO
0000327C                          2570                          
0000327C  23F9 00003F48 00003F44  2571              MOVE.L  (FPSCOUNT),(FPSREAL)    ; EN ESE CASO ACTUALIZAMOS FPS
00003286  42B9 00003F48           2572              CLR.L   (FPSCOUNT)              ; RESETEAMOS CONTADOR
0000328C                          2573  
0000328C                          2574  
0000328C  103C 0008               2575              MOVE.B  #8,D0                   ; RESETEAMOS TIEMPO
00003290  4E4F                    2576              TRAP    #15
00003292  23C1 00003F4C           2577              MOVE.L  D1,(TIME)
00003298                          2578  
00003298                          2579              
00003298                          2580                                      
00003298  60AC                    2581  .NO         BRA     .LOOP                   ; BUCLE INFINITO
0000329A  FFFF FFFF               2582              SIMHALT
0000329E                          2583  
0000329E                          2584  ; --- VARIABLES ---------------------------------------------------------------
0000329E                          2585  
0000329E                          2586              INCLUDE "SYSVAR.X68"
0000329E                          2587  ; =============================================================================
0000329E                          2588  ; VARIABLES DEL SISTEMA
0000329E                          2589  ; TEN EN CUENTA QUE TODAS ESTAS VARIABLES SE UTILIZAN PARA COMPARTIR DATOS DEL 
0000329E                          2590  ; SISTEMA AL USUARIO. POR LO TANTO, NO DEBEN ESTAR EN MEMORIA PROTEGIDA.
0000329E                          2591  ; TEN EN CUENTA QUE USAR DMMDATA DE ESTA MANERA ES UNA MALA IDEA, YA QUE LAS 
0000329E                          2592  ; APLICACIONES DE USUARIO TAMBIÉN PUEDEN LIBERAR O CAMBIAR LA PROPIEDAD. 
0000329E                          2593  ; SIN EMBARGO, PARA EL PROPÓSITO DE ESTE EJEMPLO, ES SUFICIENTEMENTE BUENO.
0000329E                          2594  ; =============================================================================
0000329E                          2595  
0000329E                          2596  ; --- VARIABLES RELACIONADAS CON EL TECLADO ----------------------------------
0000329E                          2597  
0000329E                          2598  KBDVAL      DS.B    1                       ; TECLA PULSADA = 1
0000329F                          2599  KBDEDGE     DS.B    1                       ; CAMBIO DE TECLA = 1
000032A0                          2600  
000032A0                          2601              DS.W    0
000032A0                          2602  
000032A0                          2603  ; --- VARIABLES RELACIONADAS CON LA PANTALLA ---------------------------------
000032A0                          2604  
000032A0                          2605  SCRINTCT    DS.B    1                       ; CONTADOR/FLAG DE INTERRUPCIÓN
000032A1                          2606  SCRCYCCT    DS.B    1                       ; CONTADOR DE CICLOS
000032A2                          2607              DS.W    0
000032A2                          2608  
000032A2                          2609  ; --- VARIABLES DE MEMORIA DINÁMICA ------------------------------------------
000032A2                          2610  
000032C0                          2611              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALINEAR A DMMBSIZE
000032C0                          2612  DMMDATA     DS.B    DMMBSIZE*DMMBNUM         ; ESPACIO DE ASIGNACIÓN DE 
00003F40                          2613                                               ; MEMORIA DINÁMICA
00003F40                          2614              DS.W    0                        ; POR SI ACASO
00003F40                          2615  
00003F40                          2616  
00003F40                          2617  
00003F40                          2618  
00003F40                          2619  
00003F40                          2620  -------------------- end include --------------------
00003F40                          2621              INCLUDE "VAR.X68"
00003F40                          2622  ; =============================================================================
00003F40                          2623  ; VARIABLES DEL JUEGO
00003F40                          2624  ; =============================================================================
00003F40                          2625  
00003F40                          2626  ; --- VARIABLES RELACIONADAS CON EL ESTADO DEL JUEGO --------------------------
00003F40                          2627  
00003F40                          2628  STACUR      DS.W    1                       ; ESTADO ACTUAL DEL JUEGO
00003F42                          2629  STANEXT     DS.W    1                       ; SIGUIENTE ESTADO DEL JUEGO
00003F44                          2630  FPSREAL     DS.L    1
00003F48                          2631  FPSCOUNT    DS.L    1
00003F4C                          2632  TIME        DS.L    1
00003F50                          2633  
00003F50                          2634  ; --- VARIABLES RELACIONADAS CON EL JUGADOR ----------------------------------
00003F50                          2635  
00003F50                          2636  PLRPOSX     DS.W    1                       ; POSICIÓN X DEL JUGADOR (PIXELES)
00003F52                          2637  PLRPOSY     DS.W    1                       ; POSICIÓN Y DEL JUGADOR (PIXELES)
00003F54                          2638  PLRLIFES    DS.B    1                       ; VIDAS DEL JUGADOR
00003F56                          2639  PLRSCORE    DS.W    1                       ; PUNTUACIÓN DEL JUGADOR
00003F58                          2640  PLRDMG      DS.B    1                       ; BIT0: ACTUALIZAR DAÑO, BIT1 MOSTRAR DAÑO
00003F5A                          2641              DS.W    0
00003F5A                          2642              
00003F5A                          2643  ; --- VARIABLES RELACIONADAS CON EL AUDIO ------------------------------------
00003F5A                          2644  
00003F5A                          2645  AUDACCSN    DS.B    1                       ; ¿ACEPTAR NUEVOS SONIDOS?
00003F5C                          2646              DS.W    0
00003F5C                          2647              
00003F5C                          2648  ; --- VARIABLES SOBRE LA CUENTA REGRESIVA ------------------------------------
00003F5C                          2649  
00003F5C                          2650  CICLOCR     DS.B    1                       ; NÚMERO DE CICLO PARA LA CUENTA REGRESIVA
00003F5D                          2651  NUMACTCR    DS.B    1                       ; NÚMERO ACTUAL A CONTAR
00003F5E                          2652              DS.W    0
00003F5E                          2653  
00003F5E                          2654  ; --- VARIABLES DE UTILIDAD --------------------------------------------------
00003F5E                          2655  
00003F5E                          2656  ASTMODE     DS.B    1                        ; MODO ASTEROIDE: 0 -> Ninguno
00003F5F                          2657  ;                                                              1 -> NORMAL
00003F5F                          2658  ;                                                              2 -> DIFÍCIL
00003F5F                          2659  UTLRNDIX    DS.B    1                       ; SIGUIENTE ÍNDICE PARA NÚMERO ALEATORIO
00003F60                          2660              DS.W    0
00003F60                          2661  FILEBUFF    DS.W    NUMSCOS
00003F66                          2662  
00003F66                          2663  -------------------- end include --------------------
00003F66                          2664              END    START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              16BC
AGLADD:END          16D2
AGLKILL             11C0
AGLPLOT             16FA
AGLPLOT:END         171A
AGLPLOT:LOOP        1702
AGLUPD              16D6
AGLUPD:END          16F4
AGLUPD:LOOP         16DE
AQUA                FFFF00
ASTDMG              A
ASTMODE             3F5E
ASTNFRAG            A
ASTSCORE            5
ASTTYPE             2
AUDACCN             0
AUDACCSN            3F5A
AUDACCY             FF
AUDCDFID            6
AUDCDNID            5
AUDENDID            FF
AUDGOVID            4
AUDHERID            3
AUDIMPID            2
AUDINIT             2F06
AUDINIT:AUDLIST     2F36
AUDINIT:CNTDWN      2FAF
AUDINIT:CNTDWNF     2FC4
AUDINIT:END         2F28
AUDINIT:GAMEOVER    2F9B
AUDINIT:HERIDO      2F89
AUDINIT:IDLIST      2FD3
AUDINIT:IMPACT      2F77
AUDINIT:INTRO       2F56
AUDINIT:LOOP        2F16
AUDINIT:SHOT        2F67
AUDINTID            0
AUDMSKLP            80
AUDMSKNL            0
AUDPLAY             2FDA
AUDPLAY:CONT        2FFE
AUDPLAY:DONE        300C
AUDPLAY:END         3010
AUDSHTID            1
BLACK               0
BLUE                FF0000
BSTRSIZE            5
BSTRSPEED           5
CICLOCR             3F5C
CUREUPD             3012
CUREUPD:END         3164
CUREUPD:ES2         306A
CUREUPD:ES3         30D6
CUREUPD:FINAL       3154
CUREUPD:NEXT        312A
DMMALLOC            11A6
DMMALLOC:END        11BE
DMMBNUM             32
DMMBSIZE            40
DMMDATA             32C0
DMMFCOM             1180
DMMFFND             118E
DMMFIRST            1136
DMMFLOOP            1174
DMMFRCOM            1148
DMMFREE             11C0
DMMFRFND            1156
DMMFRLOP            113C
DMMFRSTO            116E
DMMINIT             1114
DMMINIT:LOOP        1122
DMMNEXT             1158
DMMNEXTO            1190
DMMSYSID            0
ENECOL1             FFFF00
ENECOL2             FF00
ENEHEIGH            1E
ENEINIT             17E4
ENEPLOT             188A
ENEUPD              180C
ENEUPD:BOUNCE       1846
ENEUPD:COLPLAY      184A
ENEUPD:END          1880
ENEUPD:KILL         1884
ENEWIDTH            32
ENEXPLO             18EA
ENEXPLO:LOOP        1904
FILEBUFF            3F60
FNAME               11D6
FPGTXTX             41
FPGTXTY             1
FPSCOUNT            3F48
FPSGOAL             1E
FPSREAL             3F44
FPSTXTX             3F
FPSTXTY             2
FUCHSIA             FF00FF
GOVNRX              1E
GOVNRY              18
GOVSCOX             21
GOVSCOY             14
GOVSTRC             FFFFFF
GOVSTRX             23
GOVSTRY             F
GRAY                808080
GREEN               8000
HEART               1E34
HTBORDER            F
HTHEIGH             E
HTTILCL1            FF
HTTILCL2            0
HTTILCL3            FFFFFF
HTTILSIZ            3
HTWIDTH             F
IMGINTSZ            20
IMGTILSZ            8
INITCR              4
INTPRSC             FFFFFF
INTPRSX             1C
INTPRSY             1F
INTRO               1F06
KBDBITDN            3
KBDBITF1            4
KBDBITF2            5
KBDBITF3            6
KBDBITLF            0
KBDBITPS            7
KBDBITRT            2
KBDBITUP            1
KBDCHRDN            28
KBDCHRLF            25
KBDCHRMK            4D
KBDCHRPK            50
KBDCHRRT            27
KBDCHRSH            10
KBDCHRSP            20
KBDCHRUP            26
KBDDOWN             28
KBDEDGE             329F
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             10B4
KBDLEFT             25
KBDMSKDN            8
KBDMSKF1            10
KBDMSKF2            20
KBDMSKF3            40
KBDMSKLF            1
KBDMSKPS            80
KBDMSKRT            4
KBDMSKUP            2
KBDPAUSE            50
KBDREAD             10CA
KBDREAD:LOOP        110A
KBDREAD:STORE       1106
KBDRIGHT            27
KBDTRAP             0
KBDUP               26
KBDVAL              329E
LIME                FF00
LITGRAY             C0C0C0
MAROON              80
NAVY                800000
NUMACTCR            3F5D
NUMCOLOR            FFFFFF
NUMHEIGH            12C
NUMSCOS             3
NUMSIZE             1E
NUMWIDTH            C8
OLIVE               8080
ORANGE              C0FF
PLRDMG              3F58
PLRHEIGH            F
PLRINIT             1340
PLRINLIF            3
PLRLIFES            3F54
PLRNRMCL            C0FF
PLRPBDMG            1
PLRPLOT             14B2
PLRPLOT:ALTURA      167A
PLRPLOT:BLANCO      1658
PLRPLOT:END         1696
PLRPLOT:FPSGSTR     16A4
PLRPLOT:FPSSTR      16AF
PLRPLOT:LOOP        160E
PLRPLOT:MOVE        1672
PLRPLOT:NEGRO       1640
PLRPLOT:PINTAR      1668
PLRPLOT:PRHT        15EC
PLRPLOT:SCORESTR    169C
PLRPMDMG            2
PLRPOSX             3F50
PLRPOSY             3F52
PLRSCORE            3F56
PLRSPEED            5
PLRTXTCL            FFFFFF
PLRTXTX             2
PLRTXTY             1
PLRUBDMG            0
PLRUMDMG            1
PLRUPD              138C
PLRUPD:CHKDN        1422
PLRUPD:CHKRT        1402
PLRUPD:CHKUP        13E6
PLRUPD:END          14AE
PLRUPD:HER          13B8
PLRUPD:MDONE        1442
PLRUPD:NODMG        13C2
PLRUPD:NOFIRE       149E
PLRWIDTH            1E
PURPLE              800080
RED                 FF
SCOREAD             31DC
SCOREAD:LOOP        31E8
SCOREC              31AA
SCOUPD              316A
SCOUPD:ESMAYOR      318C
SCOUPD:LOOP         317C
SCOUPD:NEXT         319A
SCRCYCCT            32A1
SCRHEIGH            280
SCRINIT             101C
SCRINTCT            32A0
SCRIRQ              1
SCRISR              108C
SCRTIM              14
SCRTRAP             1
SCRUPD              109A
SCRWIDTH            280
SHTHEIGH            3
SHTINIT             1720
SHTPLOT             17AE
SHTSPEED            FFFFFFF6
SHTTYPE             1
SHTUPD              173A
SHTUPD:END          1792
SHTUPD:EXPLO        1798
SHTUPD:LOOP         1764
SHTWIDTH            14
SPWUPD              193A
SPWUPD:CONTINUE     1988
SPWUPD:END          19B6
SSTRSIZE            2
SSTRSPEED           2
STACUR              3F40
STAEMPTY            1AF6
STAGOVR             2
STAGOVRP            1CAC
STAGOVRP:GOVNRD     1D5F
STAGOVRP:GOVSCO     1D74
STAGOVRP:GOVSTR     1D54
STAGOVRP:NOESREC    1D4E
STAGOVRU            1C90
STAGOVRU:END        1CAA
STAINIT             1A60
STAINTR             0
STAINTRI            1114
STAINTRP            1B22
STAINTRP:ALTURA     1B80
STAINTRP:END        1B9C
STAINTRP:LOOP       1B54
STAINTRP:MOVE       1B78
STAINTRP:PRSSTR     1C76
STAINTRP:TITSTR     1C40
STAINTRP:TOP1       1C6A
STAINTRP:TOP2       1C6E
STAINTRP:TOP3       1C72
STAINTRP:TOPS       1C55
STAINTRU            1B0C
STAINTRU:END        1B20
STANEXT             3F42
STANONE             FFFFFFFF
STAPLAY             1
STAPLAYI            1340
STAPLAYP            1B04
STAPLAYU            1AF8
STAPLOT             1ACE
STAPLOT:PLTTBL      1AEA
START               321E
START:LOOP          3246
START:NO            3298
START:WINT          324C
STAUPD              1A78
STAUPD:DOUPD        1A9E
STAUPD:INITBL       1AB6
STAUPD:UPDTBL       1AC2
STRINIT             1D82
STRINIT:BIG         1D9E
STRINIT:END         1DAA
STRPLOT             1DFA
STRTYPE             4
STRUPD              1DC2
STRUPD:END          1DF6
SYSINIT             1000
TEAL                808000
TIME                3F4C
TOPTXTX             1E
TOPTXTY             13
TP1TXTX             22
TP1TXTY             15
TP2TXTX             22
TP2TXTY             17
TP3TXTX             22
TP3TXTY             19
UTLCHCOL            11EE
UTLCHCOL:END        121C
UTLCHCOL:NOCOL      121A
UTLINIT             11E6
UTLLOCT             28C
UTLRAND             1222
UTLRAND:RANDVEC     1240
UTLRNDIX            3F5F
UTLSFIL             145
UTLSPEN             0
WHITE               FFFFFF
XPLFILCL            FF
XPLINIT             19BC
XPLPENCL            FF
XPLPLOT             1A2A
XPLSIZE             2
XPLTYPE             3
XPLUPD              19EC
XPLUPD:END          1A20
XPLUPD:KILL         1A24
YELLOW              FFFF
